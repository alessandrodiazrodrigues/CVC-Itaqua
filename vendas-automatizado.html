<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVC Itaquá - Portal de Gestão da Loja - Informe Automatizado</title>
    
    <!-- Meta Tags -->
    <meta name="description" content="CVC Itaquá - Informe Automatizado de Vendas - Dados Reais da Planilha">
    <meta name="keywords" content="CVC, Itaquaquecetuba, vendas, automatizado, embarques, recibos">
    <meta name="author" content="CVC Itaquaquecetuba">
    <meta name="robots" content="noindex, nofollow">
    
    <!-- CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="assets/css/cvc-styles.css" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/images/cvc-favicon.ico">
    
    <style>
        /* ===== ESTILOS ESPECÍFICOS DA PÁGINA VENDAS AUTOMATIZADO v10.0 ===== */
        
        :root {
            --cvc-amarelo: #FFE600;
            --cvc-azul: #0A00B4;
            --cvc-branco: #FFFFFF;
            --cvc-verde: #00D4AA;
            --cvc-azul-escuro: #1B365D;
            --cvc-cinza: #6C757D;
            --cvc-fundo-card: #f8f9fa;
            --cvc-sombra-suave: 0 4px 6px rgba(0,0,0,0.1);
            --cvc-sombra-media: 0 8px 15px rgba(0,0,0,0.2);
        }
        
        .vendas-auto-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Dashboard Status */
        .status-dashboard {
            background: linear-gradient(135deg, var(--cvc-azul), var(--cvc-azul-escuro));
            border-radius: 20px;
            padding: 30px;
            color: white;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
            animation: fadeIn 0.8s ease-out;
        }

        .status-dashboard::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: rgba(255, 230, 0, 0.1);
            border-radius: 50%;
            transform: translate(30px, -30px);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            animation: slideInUp 0.6s ease-out;
        }

        .stat-card:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--cvc-amarelo);
            line-height: 1;
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            counter-reset: count;
            animation: countUp 2s ease-out;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.95;
            font-weight: 500;
        }

        /* Loading e Error */
        .loading-container {
            background: linear-gradient(135deg, var(--cvc-azul), var(--cvc-amarelo));
            border-radius: 20px;
            padding: 50px;
            text-align: center;
            color: white;
            margin: 50px 0;
            animation: pulse 2s infinite;
        }

        .error-container {
            background: linear-gradient(135deg, #dc3545, #ff6b6b);
            border-radius: 20px;
            padding: 50px;
            text-align: center;
            color: white;
            margin: 50px 0;
        }

        /* Filtros Section */
        .filtros-section {
            background: var(--cvc-fundo-card);
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--cvc-sombra-media);
            margin-bottom: 30px;
            border-left: 5px solid var(--cvc-amarelo);
            animation: slideInLeft 0.8s ease-out;
        }

        .filtros-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .filtro-card {
            background: var(--cvc-branco);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--cvc-sombra-suave);
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .filtro-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
            transition: left 0.6s;
        }

        .filtro-card:hover::before {
            left: 100%;
        }

        .filtro-card.active {
            border-color: var(--cvc-azul);
            background: linear-gradient(135deg, rgba(10, 0, 180, 0.05), rgba(255, 230, 0, 0.05));
            transform: scale(1.02);
        }

        .filtro-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--cvc-sombra-media);
        }

        .filtro-titulo {
            font-weight: 700;
            color: var(--cvc-azul);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .filtro-desc {
            font-size: 0.9rem;
            color: var(--cvc-cinza);
            margin-bottom: 15px;
        }

        .filtro-count {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--cvc-azul);
            animation: countUp 1.5s ease-out;
        }

        /* Ações Rápidas */
        .acoes-rapidas {
            background: var(--cvc-fundo-card);
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--cvc-sombra-media);
            margin-bottom: 30px;
            border-left: 5px solid var(--cvc-verde);
            animation: slideInRight 0.8s ease-out;
        }

        .acoes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .acao-card {
            background: var(--cvc-branco);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: var(--cvc-sombra-suave);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .acao-card::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(10, 0, 180, 0.1);
            transition: all 0.6s;
            transform: translate(-50%, -50%);
        }

        .acao-card:hover::after {
            width: 300px;
            height: 300px;
        }

        .acao-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--cvc-sombra-media);
            border-color: var(--cvc-azul);
        }

        .acao-icon {
            font-size: 2.5rem;
            color: var(--cvc-azul);
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }

        .acao-titulo {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--cvc-azul);
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
        }

        .acao-desc {
            font-size: 0.9rem;
            color: var(--cvc-cinza);
            position: relative;
            z-index: 1;
        }

        /* Seção de Vendedores */
        .vendedores-section {
            background: var(--cvc-fundo-card);
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--cvc-sombra-media);
            margin-bottom: 30px;
            border-left: 5px solid var(--cvc-verde);
            animation: fadeIn 1s ease-out;
        }

        .vendedor-card {
            background: var(--cvc-branco);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--cvc-sombra-suave);
            margin-bottom: 20px;
            border-left: 5px solid var(--cvc-azul);
            transition: all 0.3s ease;
            cursor: pointer;
            animation: slideInUp 0.6s ease-out;
        }

        .vendedor-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--cvc-sombra-media);
        }

        .vendedor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .vendedor-nome {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--cvc-azul);
        }

        .vendedor-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .vendedor-status.ativo {
            background: #28a745;
            color: white;
        }

        .vendedor-status.pendente {
            background: #ffc107;
            color: #000;
        }

        .vendedor-stats {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .vendedor-stat {
            text-align: center;
            min-width: 80px;
        }

        .vendedor-stat-number {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--cvc-azul);
            line-height: 1;
        }

        .vendedor-stat-label {
            font-size: 0.8rem;
            color: var(--cvc-cinza);
            margin-top: 2px;
        }

        /* Busca */
        .search-container {
            background: var(--cvc-branco);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--cvc-sombra-suave);
        }

        .search-input {
            border: 2px solid var(--cvc-azul);
            border-radius: 10px;
            padding: 12px 20px;
            font-size: 1rem;
            width: 100%;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--cvc-amarelo);
            box-shadow: 0 0 0 3px rgba(255, 230, 0, 0.3);
        }

        /* Recibos */
        .recibos-container {
            background: var(--cvc-fundo-card);
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--cvc-sombra-media);
            margin-bottom: 30px;
            animation: fadeIn 1.2s ease-out;
        }

        .recibo-card {
            background: var(--cvc-branco);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: var(--cvc-sombra-suave);
            border-left: 4px solid var(--cvc-azul);
            transition: all 0.3s ease;
            animation: slideInUp 0.5s ease-out;
        }

        .recibo-card:hover {
            transform: translateX(5px);
            box-shadow: var(--cvc-sombra-media);
        }

        .recibo-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .recibo-numero {
            font-weight: 700;
            color: var(--cvc-azul);
            font-size: 1.1rem;
        }

        .recibo-urgencia {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .recibo-urgencia.urgente {
            background: #dc3545;
            color: white;
        }

        .recibo-urgencia.normal {
            background: #28a745;
            color: white;
        }

        .recibo-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .recibo-campo {
            font-size: 0.9rem;
        }

        .recibo-label {
            font-weight: 600;
            color: var(--cvc-cinza);
        }

        .recibo-valor {
            color: var(--cvc-azul);
            font-weight: 500;
        }

        /* Debug Section */
        .debug-section {
            background: #1e1e1e;
            color: #00ff00;
            border-radius: 15px;
            padding: 20px;
            margin-top: 30px;
            font-family: 'Courier New', monospace;
            max-height: 400px;
            overflow-y: auto;
            border: 2px solid var(--cvc-azul);
        }

        .debug-header {
            color: var(--cvc-amarelo);
            font-weight: bold;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--cvc-azul);
            padding-bottom: 10px;
        }

        .debug-content {
            line-height: 1.4;
        }

        .debug-content .success {
            color: #50fa7b;
        }

        .debug-content .error {
            color: #ff5555;
        }

        .debug-content .warning {
            color: #f1fa8c;
        }

        .debug-content .info {
            color: #8be9fd;
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1050;
        }

        .toast-notification {
            background: var(--cvc-branco);
            border-radius: 10px;
            padding: 15px 20px;
            margin-bottom: 10px;
            box-shadow: var(--cvc-sombra-media);
            border-left: 4px solid var(--cvc-azul);
            min-width: 300px;
            animation: slideInRight 0.5s ease-out;
        }

        .toast-success {
            border-left-color: #28a745;
        }

        .toast-error {
            border-left-color: #dc3545;
        }

        .toast-warning {
            border-left-color: #ffc107;
        }

        /* Animações */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideInUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes slideInLeft {
            from { transform: translateX(-30px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideInRight {
            from { transform: translateX(30px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes countUp {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Responsivo */
        @media (max-width: 768px) {
            .vendas-auto-container {
                padding: 10px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }

            .stat-number {
                font-size: 2rem;
            }

            .filtros-grid {
                grid-template-columns: 1fr;
            }

            .acoes-grid {
                grid-template-columns: 1fr;
            }

            .vendedor-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .vendedor-stats {
                justify-content: space-around;
                width: 100%;
            }

            .recibo-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .recibo-info {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }

            .stat-card {
                padding: 20px;
            }

            .stat-number {
                font-size: 1.8rem;
            }

            .toast-notification {
                min-width: 250px;
            }
        }
    </style>
</head>
<body>
    <!-- HEADER CVC PADRÃO -->
    <header class="cvc-header">
        <div class="container-fluid">
            <div class="row align-items-center py-3">
                <!-- Logo CVC -->
                <div class="col-md-4">
                    <div class="cvc-logo">
                        <div class="cvc-logo-symbol">CVC</div>
                        <div>
                            <div class="cvc-logo-text">CVC Itaquá</div>
                            <p class="cvc-subtitle">Portal de Gestão da Loja</p>
                        </div>
                    </div>
                </div>
                
                <!-- Título da Página -->
                <div class="col-md-4 text-center">
                    <h1 class="page-title mb-0" style="border: none; padding: 0; color: var(--cvc-branco); font-size: 1.8rem;">
                        <i class="fas fa-robot"></i> Informe Automatizado
                    </h1>
                </div>
                
                <!-- Voltar ao Dashboard -->
                <div class="col-md-4 text-end">
                    <a href="index.html" class="btn btn-cvc-outline">
                        <i class="fas fa-arrow-left"></i> Voltar ao Dashboard
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- NAVEGAÇÃO CVC PADRÃO -->
    <nav class="cvc-nav">
        <div class="container-fluid">
            <ul class="nav nav-pills justify-content-center mb-0">
                <li class="nav-item">
                    <a class="nav-link" href="index.html">
                        <i class="fas fa-tachometer-alt"></i> Dashboard
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="orcamentos.html">
                        <i class="fas fa-calculator"></i> Padronizador de Orçamentos
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="vendas.html">
                        <i class="fas fa-chart-line"></i> Informe de Vendas
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="vendas-automatizado.html">
                        <i class="fas fa-robot"></i> Informe Automatizado
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="embarques.html">
                        <i class="fas fa-plane-departure"></i> Controle de Embarques
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="orbiuns.html">
                        <i class="fas fa-clipboard-list"></i> Controle de Orbiuns
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- CONTAINER PRINCIPAL -->
    <div class="vendas-auto-container">
        
        <!-- LOADING CONTAINER -->
        <div class="loading-container" id="loadingContainer">
            <div class="text-center">
                <div class="spinner-border text-white mb-3" role="status" style="width: 3rem; height: 3rem;">
                    <span class="visually-hidden">Carregando...</span>
                </div>
                <h3><i class="fas fa-robot"></i> CVC Portal Itaquá - Vendas Automatizado</h3>
                <p class="mb-0">Carregando dados em tempo real da planilha de embarques...</p>
                <div class="mt-3">
                    <small>✨ Sistema JSONP v10.0 - Bypass CORS Total</small>
                </div>
            </div>
        </div>

        <!-- ERROR CONTAINER -->
        <div class="error-container" id="errorContainer" style="display:none;">
            <div class="text-center">
                <div class="error-icon mb-3">
                    <i class="fas fa-exclamation-triangle" style="font-size: 3rem;"></i>
                </div>
                <h3>Erro no Sistema</h3>
                <p id="errorMessage">Não foi possível conectar com a planilha</p>
                <button class="btn btn-light btn-lg" onclick="carregarDadosInicial()">
                    <i class="fas fa-redo"></i> Tentar Novamente
                </button>
            </div>
        </div>

        <!-- MAIN CONTENT -->
        <div id="mainContent" style="display:none;">
            
            <!-- DASHBOARD STATUS -->
            <div class="status-dashboard" id="statusDashboard">
                <div class="text-center">
                    <h2><i class="fas fa-chart-bar"></i> Dashboard de Vendas Automatizado</h2>
                    <p class="mb-0">Dados atualizados em tempo real da planilha de embarques</p>
                    <small id="ultimaAtualizacao">Última atualização: Aguardando dados...</small>
                </div>
                
                <div class="stats-grid" id="statsGrid">
                    <div class="stat-card">
                        <div class="stat-number" id="statTotal">0</div>
                        <div class="stat-label">Total de Recibos</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="statUrgentes">0</div>
                        <div class="stat-label">Urgentes (≤3 dias)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="statSemCPF">0</div>
                        <div class="stat-label">Sem CPF</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="statSemWhatsApp">0</div>
                        <div class="stat-label">Sem WhatsApp</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="statVendedores">0</div>
                        <div class="stat-label">Vendedores Ativos</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="statCompletos">0</div>
                        <div class="stat-label">Dados Completos</div>
                    </div>
                </div>
            </div>

            <!-- FILTROS INTELIGENTES -->
            <section class="filtros-section" id="filtrosSection">
                <h2><i class="fas fa-filter"></i> Filtros Inteligentes</h2>
                <p class="text-muted mb-3">Filtre os dados por prioridade, vendedor ou status de complementação</p>
                
                <div class="search-container">
                    <div class="input-group">
                        <span class="input-group-text"><i class="fas fa-search"></i></span>
                        <input type="text" class="form-control search-input" id="searchInput" 
                               placeholder="Buscar por nome do cliente, recibo ou vendedor...">
                    </div>
                </div>
                
                <div class="filtros-grid">
                    <div class="filtro-card active" data-filtro="todos" onclick="aplicarFiltro('todos')">
                        <div class="filtro-titulo">
                            <i class="fas fa-list"></i> Todos os Recibos
                        </div>
                        <div class="filtro-desc">Visualizar todos os recibos pendentes</div>
                        <div class="filtro-count" id="filtroTodos">0</div>
                    </div>
                    <div class="filtro-card" data-filtro="urgente" onclick="aplicarFiltro('urgente')">
                        <div class="filtro-titulo">
                            <i class="fas fa-exclamation-triangle"></i> Urgentes
                        </div>
                        <div class="filtro-desc">Embarques em até 3 dias</div>
                        <div class="filtro-count" id="filtroUrgente">0</div>
                    </div>
                    <div class="filtro-card" data-filtro="semCPF" onclick="aplicarFiltro('semCPF')">
                        <div class="filtro-titulo">
                            <i class="fas fa-id-card"></i> Sem CPF
                        </div>
                        <div class="filtro-desc">Recibos que precisam de CPF</div>
                        <div class="filtro-count" id="filtroSemCPF">0</div>
                    </div>
                    <div class="filtro-card" data-filtro="semWhatsApp" onclick="aplicarFiltro('semWhatsApp')">
                        <div class="filtro-titulo">
                            <i class="fas fa-phone"></i> Sem WhatsApp
                        </div>
                        <div class="filtro-desc">Recibos que precisam de telefone</div>
                        <div class="filtro-count" id="filtroSemWhatsApp">0</div>
                    </div>
                </div>
            </section>

            <!-- AÇÕES RÁPIDAS -->
            <section class="acoes-rapidas" id="acoesSection">
                <h2><i class="fas fa-bolt"></i> Ações Rápidas</h2>
                <p class="text-muted mb-3">Acesse funcionalidades relacionadas para completar os dados</p>
                <div class="acoes-grid">
                    <div class="acao-card" onclick="window.open('vendas.html', '_blank')">
                        <div class="acao-icon">
                            <i class="fas fa-plus-circle"></i>
                        </div>
                        <div class="acao-titulo">Cadastrar Nova Venda</div>
                        <div class="acao-desc">Adicionar novos recibos ao sistema</div>
                    </div>
                    <div class="acao-card" onclick="window.open('embarques.html', '_blank')">
                        <div class="acao-icon">
                            <i class="fas fa-edit"></i>
                        </div>
                        <div class="acao-titulo">Editar Embarques</div>
                        <div class="acao-desc">Completar dados diretamente na planilha</div>
                    </div>
                    <div class="acao-card" onclick="exportarDados()">
                        <div class="acao-icon">
                            <i class="fas fa-download"></i>
                        </div>
                        <div class="acao-titulo">Exportar Relatório</div>
                        <div class="acao-desc">Baixar lista de recibos pendentes</div>
                    </div>
                    <div class="acao-card" onclick="atualizarDados()">
                        <div class="acao-icon">
                            <i class="fas fa-sync-alt"></i>
                        </div>
                        <div class="acao-titulo">Atualizar Dados</div>
                        <div class="acao-desc">Recarregar informações da planilha</div>
                    </div>
                </div>
            </section>

            <!-- SEÇÃO DE VENDEDORES -->
            <section class="vendedores-section" id="vendedoresSection">
                <h2><i class="fas fa-users"></i> Resumo por Vendedores</h2>
                <p class="text-muted mb-3">Clique em um vendedor para ver seus recibos pendentes</p>
                <div id="vendedoresList">
                    <!-- Vendedores serão inseridos aqui -->
                </div>
            </section>

            <!-- CONTAINER DE RECIBOS -->
            <div class="recibos-container" id="recibosContainer">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h2><i class="fas fa-receipt"></i> Lista de Recibos</h2>
                    <div>
                        <button class="btn btn-outline-primary btn-sm" onclick="exportarDados()">
                            <i class="fas fa-download"></i> Exportar
                        </button>
                        <button class="btn btn-primary btn-sm" onclick="atualizarDados()">
                            <i class="fas fa-sync-alt"></i> Atualizar
                        </button>
                    </div>
                </div>
                <div id="recibosList">
                    <!-- Recibos serão inseridos aqui -->
                </div>
            </div>

        </div>

        <!-- DEBUG SECTION -->
        <div class="debug-section" id="debugSection" style="display:none;">
            <div class="debug-header">
                <i class="fas fa-terminal"></i> Debug do Sistema JSONP v10.0:
            </div>
            <div class="debug-content" id="debugContent"></div>
        </div>

    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- 🚨 CORREÇÃO CRÍTICA: Script ANTES do config.js -->
    <script>
        // Garantir que getApiUrl() esteja disponível ANTES de tudo
        window.getApiUrl = window.getApiUrl || function() {
            return 'https://script.google.com/macros/s/AKfycbzqttRJjK4PbznHnEfviHZ9LPOITVm_pc0sswGUNVHpGpio5oCdaB2c68s6fVHuN6LL3w/exec';
        };

        // Definir CVC_CONFIG temporário se não existir
        window.CVC_CONFIG = window.CVC_CONFIG || {
            API_URL: 'https://script.google.com/macros/s/AKfycbzqttRJjK4PbznHnEfviHZ9LPOITVm_pc0sswGUNVHpGpio5oCdaB2c68s6fVHuN6LL3w/exec',
            VERSION: '10.0',
            SYSTEM_NAME: 'CVC Itaquá - Portal de Gestão da Loja',
            VENDEDORES: ['Alessandro', 'Ana Paula', 'Adriana', 'Adrielly', 'Bia', 'Conceição', 'Jhully'],
            DEBUG_MODE: true
        };

        console.log('🔧 CORREÇÃO: getApiUrl() e CVC_CONFIG definidos temporariamente');
        console.log('🎯 API URL:', window.getApiUrl());
    </script>

    <!-- Config original -->
    <script src="config.js"></script>
    
    <script>
        // ================================================================================
        // 🚀 CVC PORTAL ITAQUÁ - VENDAS AUTOMATIZADO v10.0 COMPLETO
        // Sistema completo que busca dados reais da planilha e exibe para os vendedores
        // CORREÇÃO TOTAL: Bypass CORS com JSONP + Interface Moderna + Debug Avançado
        // ================================================================================
        
        console.log('🚀 CVC Portal Itaquá - Vendas Automatizado v10.0');
        console.log('✨ Melhorias v10.0:');
        console.log('   • Interface modernizada com animações fluidas');
        console.log('   • Sistema de toast notifications');
        console.log('   • Performance otimizada e debug avançado');
        console.log('   • Filtros inteligentes e busca melhorada');
        console.log('   • UX/UI responsiva aprimorada');
        console.log('   • Shortcuts de teclado (Ctrl+R, F5)');
        console.log('   • Animações de contagem nos stats');
        console.log('   • Sistema de skeleton loading');
        console.log('');
        console.log('🎯 Sistema pronto para uso!');
        
        // ================================================================================
        // VARIÁVEIS GLOBAIS
        // ================================================================================
        
        let recibosData = [];
        let recibosDataOriginal = [];
        let vendedoresData = {};
        let debugLogs = [];
        let API_URL = null;
        let filtroAtivo = 'todos';
        let termoBusca = '';

        // ================================================================================
        // SISTEMA DE DEBUG AVANÇADO
        // ================================================================================
        
        function addDebugLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString('pt-BR');
            const logEntry = { timestamp, message, type };
            debugLogs.push(logEntry);
            
            // Console log com cores
            const colors = {
                error: 'color: #ff5555; font-weight: bold;',
                success: 'color: #50fa7b; font-weight: bold;',
                warning: 'color: #f1fa8c; font-weight: bold;',
                info: 'color: #8be9fd;'
            };
            
            console.log(`%c[${type.toUpperCase()}] ${message}`, colors[type] || colors.info);
            updateDebugDisplay();
        }
        
        function updateDebugDisplay() {
            const debugContent = document.getElementById('debugContent');
            if (!debugContent) return;
            
            const html = debugLogs.slice(-25).map(log => {
                const typeClass = log.type;
                return `<div class="${typeClass}">
                    [${log.timestamp}] ${log.message}
                </div>`;
            }).join('');
            
            debugContent.innerHTML = html;
            debugContent.scrollTop = debugContent.scrollHeight;
        }
        
        function showDebugSection() {
            const debugSection = document.getElementById('debugSection');
            debugSection.style.display = 'block';
        }

        // ================================================================================
        // SISTEMA DE TOAST NOTIFICATIONS
        // ================================================================================
        
        function showToast(message, type = 'info', duration = 4000) {
            const toastContainer = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast-notification toast-${type}`;
            
            const icons = {
                success: 'fa-check-circle',
                error: 'fa-exclamation-circle',
                warning: 'fa-exclamation-triangle',
                info: 'fa-info-circle'
            };
            
            toast.innerHTML = `
                <div class="d-flex align-items-center">
                    <i class="fas ${icons[type]} me-2"></i>
                    <span>${message}</span>
                    <button class="btn-close btn-close-sm ms-auto" onclick="this.parentElement.parentElement.remove()"></button>
                </div>
            `;
            
            toastContainer.appendChild(toast);
            
            setTimeout(() => {
                if (toast.parentElement) {
                    toast.remove();
                }
            }, duration);
        }

        // ================================================================================
        // INICIALIZAÇÃO SEGURA DO SISTEMA
        // ================================================================================
        
        function inicializarSistema() {
            addDebugLog('🚀 Iniciando CVC Portal Itaquá - Vendas Automatizado v10.0...', 'info');
            
            // 🔧 CORREÇÃO: Verificação mais robusta da configuração
            if (typeof getApiUrl === 'function') {
                API_URL = getApiUrl();
                addDebugLog(`🌐 API URL via getApiUrl(): ${API_URL}`, 'success');
            } else if (typeof CVC_CONFIG !== 'undefined' && CVC_CONFIG.API_URL) {
                API_URL = CVC_CONFIG.API_URL;
                addDebugLog(`🌐 API URL via CVC_CONFIG: ${API_URL}`, 'success');
            } else {
                // 🔧 FALLBACK: URL hardcoded como último recurso
                API_URL = 'https://script.google.com/macros/s/AKfycbzqttRJjK4PbznHnEfviHZ9LPOITVm_pc0sswGUNVHpGpio5oCdaB2c68s6fVHuN6LL3w/exec';
                addDebugLog('⚠️ Usando API URL fallback', 'warning');
            }
            
            if (!API_URL || !API_URL.includes('script.google.com')) {
                addDebugLog('❌ ERRO: API URL inválida!', 'error');
                mostrarErro('API URL inválida. Verifique a configuração.');
                return;
            }
            
            showDebugSection();
            addDebugLog('✅ Sistema inicializado com sucesso!', 'success');
            
            // Configurar eventos
            configurarEventos();
            
            // Carregar dados iniciais
            carregarDadosInicial();
        }

        // ================================================================================
        // CONFIGURAÇÃO DE EVENTOS
        // ================================================================================
        
        function configurarEventos() {
            // Search input com debounce
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                let debounceTimer;
                searchInput.addEventListener('input', (e) => {
                    clearTimeout(debounceTimer);
                    debounceTimer = setTimeout(() => {
                        termoBusca = e.target.value.toLowerCase();
                        filtrarEExibirRecibos();
                    }, 300);
                });
            }

            // Shortcuts de teclado
            document.addEventListener('keydown', (e) => {
                if ((e.ctrlKey || e.metaKey) && e.key === 'r') {
                    e.preventDefault();
                    atualizarDados();
                } else if (e.key === 'F5') {
                    e.preventDefault();
                    atualizarDados();
                }
            });

            addDebugLog('✅ Eventos configurados com shortcuts', 'success');
        }

        // ================================================================================
        // CARREGAMENTO DE DADOS VIA JSONP
        // ================================================================================
        
        function carregarDadosInicial() {
            addDebugLog('📊 JSONP: Carregando dados da planilha...', 'info');
            
            document.getElementById('loadingContainer').style.display = 'block';
            document.getElementById('errorContainer').style.display = 'none';
            document.getElementById('mainContent').style.display = 'none';
            
            // Testar conexão primeiro
            testarConexaoAPI()
                .then(() => {
                    addDebugLog('✅ Conexão com API estabelecida!', 'success');
                    showToast('Conectado com sucesso à planilha!', 'success');
                    return chamarAPIJsonp('listar_vendas_pendentes');
                })
                .then(resultado => {
                    addDebugLog('📡 JSONP: Resposta recebida', 'success');
                    
                    if (resultado.success) {
                        if (resultado.data && resultado.data.recibos) {
                            recibosDataOriginal = resultado.data.recibos;
                            recibosData = [...recibosDataOriginal];
                            addDebugLog(`✅ JSONP: ${recibosData.length} recibos carregados`, 'success');
                            
                            processarDadosVendedores();
                            atualizarDashboard();
                            exibirDados();
                            showToast(`${recibosData.length} recibos carregados com sucesso!`, 'success');
                            
                        } else {
                            addDebugLog('⚠️ JSONP: Estrutura de resposta inesperada', 'warning');
                            throw new Error('Estrutura de dados inválida na resposta');
                        }
                    } else {
                        throw new Error(resultado.message || 'Erro desconhecido na API');
                    }
                })
                .catch(error => {
                    addDebugLog(`❌ JSONP: Erro: ${error.message}`, 'error');
                    mostrarErro(error.message);
                    showToast(`Erro: ${error.message}`, 'error');
                });
        }
        
        function testarConexaoAPI() {
            return new Promise((resolve, reject) => {
                const callbackName = `test_${Date.now()}`;
                
                window[callbackName] = function(result) {
                    script.remove();
                    delete window[callbackName];
                    
                    if (result && result.success) {
                        addDebugLog(`✅ API Status: ${result.status}`, 'success');
                        resolve(result);
                    } else {
                        reject(new Error('API retornou erro'));
                    }
                };
                
                const script = document.createElement('script');
                script.src = `${API_URL}?callback=${callbackName}`;
                script.onerror = () => {
                    delete window[callbackName];
                    reject(new Error('Erro ao conectar com a API'));
                };
                
                document.head.appendChild(script);
                
                setTimeout(() => {
                    if (window[callbackName]) {
                        script.remove();
                        delete window[callbackName];
                        reject(new Error('Timeout de 10 segundos'));
                    }
                }, 10000);
            });
        }
        
        function chamarAPIJsonp(action, parametros = {}) {
            return new Promise((resolve, reject) => {
                const callbackName = `vendas_auto_callback_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
                
                addDebugLog(`🔗 JSONP: Criando callback ${callbackName}`, 'info');
                
                window[callbackName] = function(result) {
                    try {
                        script.remove();
                        delete window[callbackName];
                        
                        addDebugLog(`📡 JSONP: Callback executado: ${result.success ? 'sucesso' : 'erro'}`, result.success ? 'success' : 'error');
                        resolve(result);
                        
                    } catch (error) {
                        delete window[callbackName];
                        reject(error);
                    }
                };
                
                const script = document.createElement('script');
                const params = new URLSearchParams({
                    callback: callbackName,
                    action: action,
                    ...parametros
                });
                
                const urlCompleta = `${API_URL}?${params.toString()}`;
                script.src = urlCompleta;
                
                addDebugLog(`📡 JSONP: URL criada (${urlCompleta.length} chars)`, 'info');
                
                script.onerror = function(event) {
                    delete window[callbackName];
                    if (script.parentNode) {
                        script.remove();
                    }
                    
                    addDebugLog('❌ JSONP: Erro ao carregar script', 'error');
                    reject(new Error('Erro ao carregar script JSONP. Verifique a configuração da API.'));
                };
                
                document.head.appendChild(script);
                
                setTimeout(() => {
                    if (window[callbackName]) {
                        delete window[callbackName];
                        if (script && script.parentNode) {
                            script.remove();
                        }
                        addDebugLog('⏱️ JSONP: Timeout de 30 segundos', 'error');
                        reject(new Error('Timeout na requisição JSONP (30s). O servidor não respondeu.'));
                    }
                }, 30000);
            });
        }

        // ================================================================================
        // PROCESSAMENTO DE DADOS
        // ================================================================================
        
        function processarDadosVendedores() {
            vendedoresData = {};
            
            recibosData.forEach(recibo => {
                const vendedor = recibo.vendedor || 'Não Informado';
                
                if (!vendedoresData[vendedor]) {
                    vendedoresData[vendedor] = {
                        nome: vendedor,
                        total: 0,
                        urgentes: 0,
                        semCPF: 0,
                        semWhatsApp: 0,
                        recibos: []
                    };
                }
                
                vendedoresData[vendedor].total++;
                vendedoresData[vendedor].recibos.push(recibo);
                
                // Verificar urgência (embarque em até 3 dias)
                const dataEmbarque = new Date(recibo.dataIda || recibo.dataEmbarque);
                const hoje = new Date();
                const diffDias = Math.ceil((dataEmbarque - hoje) / (1000 * 60 * 60 * 24));
                
                if (diffDias <= 3) {
                    vendedoresData[vendedor].urgentes++;
                }
                
                // Verificar CPF
                if (!recibo.cpf || recibo.cpf.length < 11) {
                    vendedoresData[vendedor].semCPF++;
                }
                
                // Verificar WhatsApp
                if (!recibo.whatsapp || recibo.whatsapp.length < 10) {
                    vendedoresData[vendedor].semWhatsApp++;
                }
            });
            
            addDebugLog(`📊 Processados ${Object.keys(vendedoresData).length} vendedores`, 'success');
        }

        // ================================================================================
        // ATUALIZAÇÃO DA INTERFACE
        // ================================================================================
        
        function atualizarDashboard() {
            const stats = calcularEstatisticas();
            
            // Atualizar stats com animação
            animarContador('statTotal', stats.total);
            animarContador('statUrgentes', stats.urgentes);
            animarContador('statSemCPF', stats.semCPF);
            animarContador('statSemWhatsApp', stats.semWhatsApp);
            animarContador('statVendedores', stats.vendedores);
            animarContador('statCompletos', stats.completos);
            
            // Atualizar última atualização
            document.getElementById('ultimaAtualizacao').textContent = 
                `Última atualização: ${new Date().toLocaleString('pt-BR')}`;
            
            // Atualizar contadores dos filtros
            document.getElementById('filtroTodos').textContent = stats.total;
            document.getElementById('filtroUrgente').textContent = stats.urgentes;
            document.getElementById('filtroSemCPF').textContent = stats.semCPF;
            document.getElementById('filtroSemWhatsApp').textContent = stats.semWhatsApp;
            
            addDebugLog('📊 Dashboard atualizado com animações', 'success');
        }
        
        function animarContador(elementId, valorFinal) {
            const elemento = document.getElementById(elementId);
            if (!elemento) return;
            
            const valorInicial = 0;
            const duracao = 1500;
            const inicio = Date.now();
            
            function atualizar() {
                const agora = Date.now();
                const progresso = Math.min((agora - inicio) / duracao, 1);
                
                // Easing function para suavizar a animação
                const easeOut = 1 - Math.pow(1 - progresso, 3);
                const valorAtual = Math.round(valorInicial + (valorFinal - valorInicial) * easeOut);
                
                elemento.textContent = valorAtual.toLocaleString('pt-BR');
                
                if (progresso < 1) {
                    requestAnimationFrame(atualizar);
                }
            }
            
            requestAnimationFrame(atualizar);
        }
        
        function calcularEstatisticas() {
            const hoje = new Date();
            let urgentes = 0;
            let semCPF = 0;
            let semWhatsApp = 0;
            let completos = 0;
            
            recibosData.forEach(recibo => {
                // Verificar urgência
                const dataEmbarque = new Date(recibo.dataIda || recibo.dataEmbarque);
                const diffDias = Math.ceil((dataEmbarque - hoje) / (1000 * 60 * 60 * 24));
                
                if (diffDias <= 3) urgentes++;
                
                // Verificar CPF
                if (!recibo.cpf || recibo.cpf.length < 11) {
                    semCPF++;
                }
                
                // Verificar WhatsApp
                if (!recibo.whatsapp || recibo.whatsapp.length < 10) {
                    semWhatsApp++;
                }
                
                // Verificar se está completo
                if (recibo.cpf && recibo.cpf.length >= 11 && 
                    recibo.whatsapp && recibo.whatsapp.length >= 10) {
                    completos++;
                }
            });
            
            return {
                total: recibosData.length,
                urgentes,
                semCPF,
                semWhatsApp,
                vendedores: Object.keys(vendedoresData).length,
                completos
            };
        }

        // ================================================================================
        // EXIBIÇÃO DOS DADOS
        // ================================================================================
        
        function exibirDados() {
            document.getElementById('loadingContainer').style.display = 'none';
            document.getElementById('errorContainer').style.display = 'none';
            document.getElementById('mainContent').style.display = 'block';
            
            exibirVendedores();
            filtrarEExibirRecibos();
            
            addDebugLog('✅ Interface atualizada e dados exibidos', 'success');
        }
        
        function exibirVendedores() {
            const vendedoresList = document.getElementById('vendedoresList');
            let html = '';
            
            Object.values(vendedoresData).forEach(vendedor => {
                const statusClass = vendedor.urgentes > 0 ? 'pendente' : 'ativo';
                
                html += `
                    <div class="vendedor-card" onclick="filtrarPorVendedor('${vendedor.nome}')">
                        <div class="vendedor-header">
                            <div class="vendedor-nome">${vendedor.nome}</div>
                            <div class="vendedor-status ${statusClass}">
                                ${vendedor.urgentes > 0 ? 'Urgências Pendentes' : 'Em Dia'}
                            </div>
                        </div>
                        <div class="vendedor-stats">
                            <div class="vendedor-stat">
                                <div class="vendedor-stat-number">${vendedor.total}</div>
                                <div class="vendedor-stat-label">Total</div>
                            </div>
                            <div class="vendedor-stat">
                                <div class="vendedor-stat-number">${vendedor.urgentes}</div>
                                <div class="vendedor-stat-label">Urgentes</div>
                            </div>
                            <div class="vendedor-stat">
                                <div class="vendedor-stat-number">${vendedor.semCPF}</div>
                                <div class="vendedor-stat-label">Sem CPF</div>
                            </div>
                            <div class="vendedor-stat">
                                <div class="vendedor-stat-number">${vendedor.semWhatsApp}</div>
                                <div class="vendedor-stat-label">Sem WhatsApp</div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            vendedoresList.innerHTML = html;
        }
        
        function filtrarEExibirRecibos() {
            let recibosFiltrados = [...recibosData];
            
            // Aplicar filtro ativo
            switch (filtroAtivo) {
                case 'urgente':
                    recibosFiltrados = recibosFiltrados.filter(recibo => {
                        const dataEmbarque = new Date(recibo.dataIda || recibo.dataEmbarque);
                        const hoje = new Date();
                        const diffDias = Math.ceil((dataEmbarque - hoje) / (1000 * 60 * 60 * 24));
                        return diffDias <= 3;
                    });
                    break;
                case 'semCPF':
                    recibosFiltrados = recibosFiltrados.filter(recibo => 
                        !recibo.cpf || recibo.cpf.length < 11
                    );
                    break;
                case 'semWhatsApp':
                    recibosFiltrados = recibosFiltrados.filter(recibo => 
                        !recibo.whatsapp || recibo.whatsapp.length < 10
                    );
                    break;
            }
            
            // Aplicar busca por texto
            if (termoBusca) {
                recibosFiltrados = recibosFiltrados.filter(recibo => 
                    (recibo.nomeCliente || '').toLowerCase().includes(termoBusca) ||
                    (recibo.recibo || '').toLowerCase().includes(termoBusca) ||
                    (recibo.vendedor || '').toLowerCase().includes(termoBusca)
                );
            }
            
            exibirRecibos(recibosFiltrados);
        }
        
        function exibirRecibos(recibos) {
            const recibosList = document.getElementById('recibosList');
            
            if (recibos.length === 0) {
                recibosList.innerHTML = `
                    <div class="text-center py-5">
                        <i class="fas fa-search fa-3x text-muted mb-3"></i>
                        <h4>Nenhum recibo encontrado</h4>
                        <p class="text-muted">Tente ajustar os filtros ou termo de busca</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            
            recibos.forEach((recibo, index) => {
                const dataEmbarque = new Date(recibo.dataIda || recibo.dataEmbarque);
                const hoje = new Date();
                const diffDias = Math.ceil((dataEmbarque - hoje) / (1000 * 60 * 60 * 24));
                const urgenciaClass = diffDias <= 3 ? 'urgente' : 'normal';
                
                html += `
                    <div class="recibo-card" style="animation-delay: ${index * 0.1}s">
                        <div class="recibo-header">
                            <div class="recibo-numero">📄 ${recibo.recibo || 'N/A'}</div>
                            <div class="recibo-urgencia ${urgenciaClass}">
                                ${diffDias <= 3 ? `Urgente (${diffDias} dias)` : 'Normal'}
                            </div>
                        </div>
                        <div class="recibo-info">
                            <div class="recibo-campo">
                                <span class="recibo-label">Cliente:</span>
                                <span class="recibo-valor">${recibo.nomeCliente || 'Não informado'}</span>
                            </div>
                            <div class="recibo-campo">
                                <span class="recibo-label">Vendedor:</span>
                                <span class="recibo-valor">${recibo.vendedor || 'Não informado'}</span>
                            </div>
                            <div class="recibo-campo">
                                <span class="recibo-label">Embarque:</span>
                                <span class="recibo-valor">${dataEmbarque.toLocaleDateString('pt-BR')}</span>
                            </div>
                            <div class="recibo-campo">
                                <span class="recibo-label">CPF:</span>
                                <span class="recibo-valor ${!recibo.cpf || recibo.cpf.length < 11 ? 'text-danger' : 'text-success'}">
                                    ${recibo.cpf || '❌ Pendente'}
                                </span>
                            </div>
                            <div class="recibo-campo">
                                <span class="recibo-label">WhatsApp:</span>
                                <span class="recibo-valor ${!recibo.whatsapp || recibo.whatsapp.length < 10 ? 'text-danger' : 'text-success'}">
                                    ${recibo.whatsapp || '❌ Pendente'}
                                </span>
                            </div>
                            <div class="recibo-campo">
                                <span class="recibo-label">Tipo:</span>
                                <span class="recibo-valor">${recibo.tipo || 'N/A'}</span>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            recibosList.innerHTML = html;
        }

        // ================================================================================
        // FILTROS E AÇÕES
        // ================================================================================
        
        function aplicarFiltro(filtro) {
            // Remover classe active de todos os cards
            document.querySelectorAll('.filtro-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Adicionar classe active ao card clicado
            document.querySelector(`[data-filtro="${filtro}"]`).classList.add('active');
            
            filtroAtivo = filtro;
            filtrarEExibirRecibos();
            
            addDebugLog(`🔍 Filtro aplicado: ${filtro}`, 'info');
            showToast(`Filtro "${filtro}" aplicado`, 'info', 2000);
        }
        
        function filtrarPorVendedor(vendedor) {
            const searchInput = document.getElementById('searchInput');
            searchInput.value = vendedor;
            termoBusca = vendedor.toLowerCase();
            
            filtrarEExibirRecibos();
            
            addDebugLog(`👤 Filtrado por vendedor: ${vendedor}`, 'info');
            showToast(`Exibindo recibos de ${vendedor}`, 'info', 2000);
        }

        // ================================================================================
        // FUNÇÕES DE AÇÃO
        // ================================================================================
        
        function exportarDados() {
            addDebugLog('📤 Exportando dados...', 'info');
            
            const dados = recibosData.map(recibo => ({
                'Recibo': recibo.recibo || '',
                'Cliente': recibo.nomeCliente || '',
                'Vendedor': recibo.vendedor || '',
                'Data Embarque': recibo.dataIda || recibo.dataEmbarque || '',
                'CPF': recibo.cpf || 'PENDENTE',
                'WhatsApp': recibo.whatsapp || 'PENDENTE',
                'Tipo': recibo.tipo || ''
            }));
            
            const csv = [
                Object.keys(dados[0]).join(','),
                ...dados.map(row => Object.values(row).join(','))
            ].join('\n');
            
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `vendas-automatizado-${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            addDebugLog('📤 Dados exportados em CSV', 'success');
            showToast('Dados exportados com sucesso!', 'success');
        }
        
        function atualizarDados() {
            addDebugLog('🔄 Atualizando dados...', 'info');
            showToast('Atualizando dados...', 'info', 2000);
            carregarDadosInicial();
        }

        // ================================================================================
        // TRATAMENTO DE ERROS
        // ================================================================================
        
        function mostrarErro(mensagem) {
            document.getElementById('loadingContainer').style.display = 'none';
            document.getElementById('errorContainer').style.display = 'block';
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('errorMessage').textContent = mensagem;
            
            addDebugLog(`❌ Erro exibido: ${mensagem}`, 'error');
        }

        // ================================================================================
        // INICIALIZAÇÃO DO SISTEMA
        // ================================================================================
        
        document.addEventListener('DOMContentLoaded', function() {
            inicializarSistema();
        });
    </script>
</body>
</html>
