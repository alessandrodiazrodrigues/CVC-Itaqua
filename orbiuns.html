<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SYSTELOS TUR - Controle de Orbiuns</title>

    <!-- Meta Tags -->
    <meta name="description" content="SYSTELOS TUR - Sistemas com prop√≥sito">
    <meta name="keywords" content="SYSTELOS, TUR, Itaquaquecetuba, gest√£o, viagens, turismo, sistema">
    <meta name="author" content="SYSTELOS TUR">
    <meta name="robots" content="noindex, nofollow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="SYSTELOS TUR - Sistema Integrado de Gest√£o">
    <meta property="og:description" content="Sistema de gest√£o integrado da CVC Itaquaquecetuba">
    <meta property="og:image" content="assets/images/systelos-logo.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/images/systelos-favicon.ico">
    <link rel="apple-touch-icon" href="assets/images/systelos-apple-icon.png">
    
    <!-- CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="assets/css/systelos-styles.css" rel="stylesheet">
    
    <!-- Config.js Centralizado -->
    <script src="config.js"></script>
    
    <style>
        /* ============================================================================
           ESTILOS ESPEC√çFICOS DO CONTROLE DE ORBIUNS
           ============================================================================ */
        
        .main-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: var(--systelos-sombra-forte);
            backdrop-filter: blur(10px);
            margin: 20px auto;
            max-width: 1400px;
            overflow: hidden;
        }
        
        .content-section {
            padding: 30px;
        }
        
        /* ============================================================================
           SE√á√ÉO DE NOTIFICA√á√ïES WEBHOOK
           ============================================================================ */
        
        .secao-atualizacoes {
            background: linear-gradient(135deg, #FFF3CD 0%, #FFE69C 100%);
            border: 2px solid #FFB800;
            border-radius: 15px;
            padding: 20px;
            margin: 20px auto;
            max-width: 1400px;
            box-shadow: 0 4px 15px rgba(255, 184, 0, 0.3);
            display: none; /* Oculto por padr√£o, aparece quando houver notifica√ß√µes */
        }
        
        .secao-atualizacoes.show {
            display: block;
        }
        
        .atualizacoes-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 184, 0, 0.3);
        }
        
        .atualizacoes-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.3rem;
            font-weight: 700;
            color: #0F1B3D;
        }
        
        .sino-animado {
            animation: balanco 2s ease-in-out infinite;
            color: #FF6B6B;
        }
        
        @keyframes balanco {
            0%, 100% { transform: rotate(0deg); }
            10%, 30% { transform: rotate(-10deg); }
            20%, 40% { transform: rotate(10deg); }
        }
        
        .badge-notificacao {
            background: #FF4444;
            color: white;
            font-size: 0.85rem;
            font-weight: 700;
            padding: 4px 10px;
            border-radius: 20px;
            min-width: 30px;
            text-align: center;
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 68, 68, 0.7); }
            50% { transform: scale(1.1); box-shadow: 0 0 0 10px rgba(255, 68, 68, 0); }
        }
        
        .btn-marcar-todas {
            background: #28A745;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-marcar-todas:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.4);
        }
        
        .atualizacoes-lista {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .atualizacao-card {
            background: white;
            border: 2px solid #FFA500;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(255, 165, 0, 0.2);
            transition: all 0.3s ease;
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .atualizacao-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 165, 0, 0.3);
        }
        
        .atualizacao-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid #FFE69C;
        }
        
        .atualizacao-orbium {
            font-size: 1.1rem;
            font-weight: 700;
            color: #0F1B3D;
        }
        
        .atualizacao-status {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .atualizacao-status.resolvido {
            background: #D4EDDA;
            color: #155724;
        }
        
        .atualizacao-status.em-andamento {
            background: #FFF3CD;
            color: #856404;
        }
        
        .atualizacao-status.pendente {
            background: #F8D7DA;
            color: #721C24;
        }
        
        .atualizacao-body {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-bottom: 15px;
        }
        
        .atualizacao-info {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #495057;
            font-size: 0.95rem;
        }
        
        .atualizacao-info i {
            color: #0F1B3D;
            width: 20px;
        }
        
        .atualizacao-observacoes {
            background: #F8F9FA;
            padding: 12px;
            border-radius: 8px;
            border-left: 4px solid #FFB800;
            margin-bottom: 15px;
            font-size: 0.9rem;
            color: #495057;
            line-height: 1.5;
        }
        
        .atualizacao-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .atualizacao-timestamp {
            color: #6C757D;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .btn-marcar-lido {
            background: #28A745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.9rem;
        }
        
        .btn-marcar-lido:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(40, 167, 69, 0.3);
        }
        
        /* ============================================================================
           KPIs DISCRETOS NO TOPO
           ============================================================================ */
        
        .kpis-container {
            background: linear-gradient(135deg, #0F1B3D 0%, #1a2951 100%);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(15, 27, 61, 0.2);
        }
        
        .kpis-title {
            color: #FFB800;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .kpis-vendedores {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }
        
        .kpi-vendedor {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 184, 0, 0.3);
            border-radius: 10px;
            padding: 10px 15px;
            min-width: 140px;
            transition: all 0.3s ease;
        }
        
        .kpi-vendedor:hover {
            background: rgba(255, 184, 0, 0.1);
            border-color: #FFB800;
            transform: translateY(-2px);
        }
        
        .kpi-vendedor-nome {
            color: white;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .kpi-vendedor-numero {
            color: #FFB800;
            font-size: 1.8rem;
            font-weight: bold;
            line-height: 1;
        }
        
        .kpi-vendedor-label {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.75rem;
            margin-top: 3px;
        }
        
        .kpis-total {
            border-top: 1px solid rgba(255, 184, 0, 0.3);
            padding-top: 15px;
            color: white;
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .kpis-total span {
            color: #FFB800;
            font-size: 1.5rem;
            margin-left: 10px;
        }
        
        /* ============================================================================
           HEADER LINKS
           ============================================================================ */
        
        .header-links {
            background: var(--systelos-bg-info-light);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 25px;
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .header-link {
            background: white;
            color: var(--systelos-azul);
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }
        
        .header-link:hover {
            background: var(--systelos-azul);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(10, 0, 180, 0.3);
            text-decoration: none;
        }
        
        /* ============================================================================
           FILTROS
           ============================================================================ */
        
        .filter-section {
            background: var(--systelos-branco);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--systelos-sombra-suave);
            border-left: 4px solid var(--systelos-azul);
        }
        
        .filter-section h4 {
            color: var(--systelos-azul);
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-control-cvc, .form-select-cvc {
            border: 2px solid var(--systelos-border);
            border-radius: 10px;
            padding: 10px 15px;
            transition: all 0.3s ease;
        }
        
        .form-control-cvc:focus, .form-select-cvc:focus {
            border-color: var(--systelos-azul);
            box-shadow: 0 0 0 0.2rem rgba(15, 27, 61, 0.1);
        }
        
        .form-label {
            font-weight: 600;
            color: var(--systelos-texto-escuro);
            margin-bottom: 8px;
        }
        
        /* ============================================================================
           CARDS DE ORBIUNS
           ============================================================================ */
        
        .orbium-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--systelos-sombra-media);
            border-left: 5px solid var(--systelos-azul);
            transition: all 0.3s ease;
        }
        
        .orbium-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--systelos-sombra-forte);
        }
        
        .orbium-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--systelos-border);
        }
        
        .orbium-numero {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--systelos-azul);
        }
        
        .orbium-status {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .orbium-status.problema {
            background: var(--systelos-bg-error-light);
            color: var(--systelos-erro);
        }
        
        .orbium-status.em-atendimento {
            background: var(--systelos-bg-warning-light);
            color: var(--systelos-warning);
        }
        
        .orbium-status.resolvido {
            background: var(--systelos-bg-success-light);
            color: var(--systelos-sucesso);
        }
        
        .orbium-status.pendente {
            background: var(--systelos-bg-info-light);
            color: var(--systelos-info);
        }
        
        .orbium-body {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .orbium-info {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: var(--systelos-bg-light);
            border-radius: 8px;
        }
        
        .orbium-info i {
            color: var(--systelos-azul);
            font-size: 1.1rem;
            width: 25px;
        }
        
        .orbium-info-label {
            font-size: 0.8rem;
            color: var(--systelos-texto-claro);
            font-weight: 600;
        }
        
        .orbium-info-value {
            font-size: 0.95rem;
            color: var(--systelos-texto-escuro);
            font-weight: 600;
        }
        
        .orbium-observacoes {
            background: var(--systelos-bg-info-light);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid var(--systelos-info);
            margin-bottom: 20px;
        }
        
        .orbium-observacoes strong {
            display: block;
            margin-bottom: 8px;
            color: var(--systelos-azul);
        }
        
        .orbium-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .orbium-data {
            color: var(--systelos-texto-claro);
            font-size: 0.9rem;
        }
        
        .orbium-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .btn-action {
            padding: 8px 16px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        
        .btn-action:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .btn-whatsapp {
            background: #25D366;
            color: white;
        }
        
        .btn-whatsapp:hover {
            background: #1ebe56;
        }
        
        .btn-editar {
            background: var(--systelos-warning);
            color: white;
        }
        
        .btn-editar:hover {
            background: #d39e00;
        }
        
        .btn-deletar {
            background: var(--systelos-erro);
            color: white;
        }
        
        .btn-deletar:hover {
            background: #c82333;
        }
        
        /* ============================================================================
           MODAL
           ============================================================================ */
        
        .modal-header-systelos {
            background: linear-gradient(135deg, var(--systelos-azul) 0%, #1a2951 100%);
            color: white;
            border-radius: 15px 15px 0 0;
            padding: 20px 25px;
        }
        
        .modal-header-systelos .modal-title {
            font-weight: 700;
            font-size: 1.3rem;
        }
        
        .modal-header-systelos .btn-close {
            filter: brightness(0) invert(1);
        }
        
        .modal-content {
            border-radius: 15px;
            border: none;
            box-shadow: var(--systelos-sombra-forte);
        }
        
        .modal-body {
            padding: 30px;
        }
        
        /* ============================================================================
           CAMPO COLAR DADOS COM AUTO-PREENCHIMENTO
           ============================================================================ */
        
        .colar-dados-container {
            background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%);
            border: 2px dashed var(--systelos-azul);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .colar-dados-title {
            color: var(--systelos-azul);
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .colar-dados-textarea {
            width: 100%;
            min-height: 120px;
            border: 2px solid var(--systelos-azul);
            border-radius: 10px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            resize: vertical;
            background: white;
        }
        
        .colar-dados-textarea:focus {
            outline: none;
            border-color: var(--systelos-amarelo);
            box-shadow: 0 0 0 0.2rem rgba(255, 184, 0, 0.25);
        }
        
        .colar-dados-btn {
            width: 100%;
            background: linear-gradient(135deg, var(--systelos-amarelo) 0%, #FFA500 100%);
            color: var(--systelos-azul);
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .colar-dados-btn:hover {
            background: linear-gradient(135deg, #FFA500 0%, var(--systelos-amarelo) 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 184, 0, 0.4);
        }
        
        .campos-preenchidos {
            background: #D4EDDA;
            border: 2px solid #28A745;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            display: none;
        }
        
        .campos-preenchidos.show {
            display: block;
        }
        
        .campos-preenchidos h6 {
            color: #155724;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .campos-preenchidos ul {
            margin: 0;
            padding-left: 20px;
            color: #155724;
        }
        
        .campos-preenchidos li {
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .campos-vazios {
            background: #FFF3CD;
            border: 2px solid #FFC107;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            display: none;
        }
        
        .campos-vazios.show {
            display: block;
        }
        
        .campos-vazios h6 {
            color: #856404;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .campos-vazios ul {
            margin: 0;
            padding-left: 20px;
            color: #856404;
        }
        
        .campos-vazios li {
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        /* ============================================================================
           FORMUL√ÅRIO
           ============================================================================ */
        
        .form-row-titulo {
            color: var(--systelos-azul);
            font-weight: 700;
            font-size: 1.1rem;
            margin: 25px 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--systelos-border);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .campo-obrigatorio {
            color: var(--systelos-erro);
            font-weight: 600;
        }
        
        /* ============================================================================
           BOT√ïES
           ============================================================================ */
        
        .btn-systelos-primary {
            background-color: #FFB800;
            color: #0F1B3D;
            border: 2px solid #FFB800;
            padding: 10px 30px;
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.3s ease;
            visibility: visible;
            opacity: 1;
        }

        .btn-systelos-primary:hover {
            background-color: #FFA500;
            border-color: #FFA500;
            color: #0F1B3D;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 184, 0, 0.4);
        }

        #salvarDados {
            background-color: #FFB800 !important;
            color: #0F1B3D !important;
            font-weight: 600 !important;
            padding: 14px 40px !important;
            border: 2px solid #FFB800 !important;
            border-radius: 10px !important;
            visibility: visible !important;
            opacity: 1 !important;
            display: inline-block !important;
            cursor: pointer !important;
            font-family: 'Inter', sans-serif !important;
            font-size: 16px !important;
            box-shadow: 0 2px 8px rgba(255,184,0,0.3) !important;
            transition: all 0.3s ease !important;
        }

        #salvarDados:hover {
            background-color: #0F1B3D !important;
            color: #FFB800 !important;
            border-color: #FFB800 !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 15px rgba(255,184,0,0.5) !important;
        }

        .btn-systelos-secondary {
            background: var(--systelos-cinza-claro);
            border: 2px solid var(--systelos-border);
            color: var(--systelos-azul);
            padding: 12px 30px;
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-systelos-secondary:hover {
            background: var(--systelos-branco);
            border-color: var(--systelos-azul);
            color: var(--systelos-azul);
        }
        
        /* ============================================================================
           ALERTAS
           ============================================================================ */
        
        .alert-custom {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 9999;
            max-width: 400px;
            animation: slideInRight 0.3s ease-out;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
        }
        
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .alert-success-custom {
            background: #D4EDDA;
            border-left: 5px solid #28A745;
            color: #155724;
        }
        
        .alert-error-custom {
            background: #F8D7DA;
            border-left: 5px solid #DC3545;
            color: #721C24;
        }
        
        /* ============================================================================
           LOADING
           ============================================================================ */
        
        .loading-container {
            text-align: center;
            padding: 60px 20px;
        }
        
        .loading-spinner {
            border: 4px solid rgba(15, 27, 61, 0.1);
            border-top: 4px solid var(--systelos-azul);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ============================================================================
           RESPONSIVIDADE
           ============================================================================ */
        
        @media (max-width: 768px) {
            .content-section {
                padding: 20px;
            }
            
            .kpis-vendedores {
                flex-direction: column;
            }
            
            .kpi-vendedor {
                width: 100%;
            }
            
            .header-links {
                flex-direction: column;
            }
            
            .header-link {
                width: 100%;
                justify-content: center;
            }
            
            .orbium-header {
                flex-direction: column;
                gap: 10px;
            }
            
            .orbium-footer {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .orbium-actions {
                width: 100%;
                flex-wrap: wrap;
            }
            
            .btn-action {
                flex: 1;
                min-width: 120px;
                justify-content: center;
            }
        }
    </style>
</head>
<body class="systelos-body">
    <!-- ============================================================================
         NAVBAR PADR√ÉO SYSTELOS TUR
         ============================================================================ -->
    <nav class="navbar navbar-expand-lg navbar-dark" style="background: linear-gradient(135deg, #0F1B3D 0%, #1a2951 100%); padding: 1rem 2rem; box-shadow: 0 4px 15px rgba(15, 27, 61, 0.3);">
        <div class="container-fluid">
            <!-- Logo -->
            <a class="navbar-brand d-flex align-items-center" href="index.html" style="font-weight: 700; font-size: 1.3rem; gap: 10px;">
                <div style="background: #FFB800; width: 45px; height: 45px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.4rem; font-weight: 800; color: #0F1B3D;">
                    [S]
                </div>
                <div>
                    <div style="line-height: 1.2; font-family: 'Poppins', sans-serif;">SYSTELOS TUR</div>
                    <div style="font-size: 0.7rem; font-weight: 400; color: rgba(255,255,255,0.7); font-family: 'Inter', sans-serif;">Sistemas com prop√≥sito</div>
                </div>
            </a>

            <!-- Toggle para mobile -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMain">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- Menu Principal -->
            <div class="collapse navbar-collapse" id="navbarMain">
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">
                            <i class="fas fa-home me-2"></i>Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="orcamentos.html">
                            <i class="fas fa-wand-magic-sparkles me-2"></i>Padronizador de Or√ßamentos
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="vendas.html">
                            <i class="fas fa-chart-line me-2"></i>Informe de Vendas
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="vendas-automatizado.html">
                            <i class="fas fa-robot me-2"></i>Informe Automatizado
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="embarques.html">
                            <i class="fas fa-plane me-2"></i>Controle de Embarques
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="orbiuns.html">
                            <i class="fas fa-clipboard-list me-2"></i>Controle de Orbiuns
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="importacao.html">
                            <i class="fas fa-upload me-2"></i>Importa√ß√£o
                        </a>
                    </li>
                </ul>

                <!-- Bot√µes de Usu√°rio -->
                <div class="d-flex gap-2 align-items-center">
                    <span style="color: rgba(255,255,255,0.8); font-size: 0.9rem; margin-right: 10px;">
                        <i class="fas fa-crown me-2" style="color: #FFB800;"></i>
                        Gestor SYSTELOS
                    </span>
                    <span style="color: rgba(255,255,255,0.6); font-size: 0.85rem;">Gestor</span>
                    <button onclick="window.location.href='index.html'" style="background: #FFB800; color: #0F1B3D; border: none; padding: 8px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
                        <i class="fas fa-sign-out-alt me-2"></i>Sair
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- ============================================================================
         MENU LATERAL (SIDEBAR)
         ============================================================================ -->
    <nav id="sidebarMenu" class="sidebar-menu">
        <div class="sidebar-header" style="position: relative; border-bottom: 1px solid rgba(255,184,0,0.3); padding: 20px;">
            <h3 style="color: #FFB800; font-family: Poppins, sans-serif; margin: 0; font-size: 1.2rem; font-weight: 700;">[S] SYSTELOS TUR</h3>
            <button id="closeSidebar" style="position: absolute; top: 15px; right: 15px; background: transparent; border: none; color: white; font-size: 32px; cursor: pointer; width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: 0.3s;">&times;</button>
        </div>
        <ul style="list-style: none; padding: 0; margin: 0;">
            <li><a href="index.html" style="display: block; padding: 18px 25px; color: white; text-decoration: none; transition: 0.3s; font-family: Inter, sans-serif; font-size: 15px; border-bottom: 1px solid rgba(255,255,255,0.1);">In√≠cio</a></li>
            <li><a href="orcamentos.html" style="display: block; padding: 18px 25px; color: white; text-decoration: none; transition: 0.3s; font-family: Inter, sans-serif; font-size: 15px; border-bottom: 1px solid rgba(255,255,255,0.1);">Padronizador de Or√ßamentos</a></li>
            <li><a href="embarques.html" style="display: block; padding: 18px 25px; color: white; text-decoration: none; transition: 0.3s; font-family: Inter, sans-serif; font-size: 15px; border-bottom: 1px solid rgba(255,255,255,0.1);">Controle de Embarques</a></li>
            <li><a href="vendas.html" style="display: block; padding: 18px 25px; color: white; text-decoration: none; transition: 0.3s; font-family: Inter, sans-serif; font-size: 15px; border-bottom: 1px solid rgba(255,255,255,0.1);">Informe de Vendas</a></li>
            <li><a href="orbiuns.html" style="display: block; padding: 18px 25px; color: #FFB800; text-decoration: none; transition: 0.3s; font-family: Inter, sans-serif; font-size: 15px; background: rgba(255,184,0,0.2); border-left: 4px solid #FFB800; font-weight: 600;">Orbiuns (Processos)</a></li>
            <li><a href="importacao.html" style="display: block; padding: 18px 25px; color: white; text-decoration: none; transition: 0.3s; font-family: Inter, sans-serif; font-size: 15px;">Importa√ß√£o de Dados</a></li>
        </ul>
    </nav>

    <style>
        /* Hover effects para navbar */
        .navbar .nav-link:not(.active):hover {
            background: rgba(255, 184, 0, 0.1) !important;
            color: #FFB800 !important;
        }

        /* ============================================================================
           HEADER FIXO NO TOPO
           ============================================================================ */

        /* Header fixo no topo - n√£o faz scroll */
        .navbar, header, .main-header {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            width: 100% !important;
            z-index: 1000 !important;
            background: linear-gradient(135deg, #0F1B3D 0%, #1a2951 100%) !important;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3) !important;
        }

        /* Compensar altura do header fixo */
        body {
            padding-top: 85px !important;
        }

        .navbar {
            height: 70px;
        }

        /* Container principal sem margem extra */
        .container-fluid, .main-container, main {
            margin-top: 0 !important;
        }

        /* ============================================================================
           MENU HAMB√öRGUER
           ============================================================================ */

        /* Bot√£o menu hamb√∫rguer posicionado √† esquerda */
        .navbar-toggler, #menuToggle {
            position: absolute !important;
            left: 20px !important;
            top: 50% !important;
            transform: translateY(-50%) !important;
            z-index: 1001 !important;
            border: 2px solid #FFB800 !important;
            padding: 8px 12px !important;
            background: transparent !important;
        }

        .navbar-toggler-icon {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba(255, 184, 0, 1)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
        }

        /* Ajustar logo para deixar espa√ßo para o hamb√∫rguer */
        .navbar-brand {
            margin-left: 60px !important;
        }

        /* ============================================================================
           SIDEBAR MENU LATERAL
           ============================================================================ */

        .sidebar-menu {
            position: fixed;
            left: -340px;
            top: 0;
            width: 320px;
            height: 100vh;
            background: #0F1B3D;
            transition: left 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 9999;
            box-shadow: 2px 0 20px rgba(0,0,0,0.5);
            overflow-y: auto;
        }

        .sidebar-menu.show {
            left: 0;
        }

        /* Scrollbar personalizada */
        .sidebar-menu::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar-menu::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.05);
        }

        .sidebar-menu::-webkit-scrollbar-thumb {
            background: rgba(255,184,0,0.5);
            border-radius: 3px;
        }

        .sidebar-menu::-webkit-scrollbar-thumb:hover {
            background: rgba(255,184,0,0.7);
        }

        /* Bot√£o fechar sidebar */
        #closeSidebar:hover {
            background: rgba(255,184,0,0.2) !important;
            transform: rotate(90deg);
        }

        /* Overlay escuro */
        #sidebarOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.7);
            z-index: 9998;
            display: none;
            transition: opacity 0.3s;
            backdrop-filter: blur(3px);
        }
    </style>

    <!-- Script para hover nos links do menu lateral -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const menuLinks = document.querySelectorAll('#sidebarMenu a');
            menuLinks.forEach(link => {
                if (!link.href.includes('orbiuns.html')) {
                    link.addEventListener('mouseenter', function() {
                        this.style.background = 'rgba(255,184,0,0.15)';
                        this.style.paddingLeft = '35px';
                    });
                    link.addEventListener('mouseleave', function() {
                        this.style.background = 'transparent';
                        this.style.paddingLeft = '25px';
                    });
                }
            });
        });
    </script>

    <!-- ============================================================================
         SE√á√ÉO DE ATUALIZA√á√ïES RECENTES (WEBHOOK ORBIUNS)
         ============================================================================ -->
    <div class="container-fluid" style="padding: 30px 30px 0 30px;">
        <section class="secao-atualizacoes" id="secaoAtualizacoes">
            <div class="atualizacoes-header">
                <div class="atualizacoes-title">
                    <i class="fas fa-bell sino-animado"></i>
                    Atualiza√ß√µes Recentes
                    <span class="badge-notificacao" id="contadorNotificacoes">0</span>
                </div>
                <button class="btn-marcar-todas" onclick="marcarTodasComoLidas()">
                    <i class="fas fa-check-double"></i>
                    Marcar todas como lidas
                </button>
            </div>
            <div class="atualizacoes-lista" id="listaAtualizacoes">
                <!-- Atualiza√ß√µes inseridas via JavaScript -->
                <div class="loading-container">
                    <div class="loading-spinner"></div>
                    <p class="mt-3">Buscando atualiza√ß√µes recentes...</p>
                </div>
            </div>
        </section>
    </div>

    <!-- ============================================================================
         CONTAINER PRINCIPAL
         ============================================================================ -->
    <div class="container-fluid" style="padding: 30px;">
        <div class="main-container">
            <!-- Conte√∫do -->
            <div class="content-section">
                
                <!-- KPIs DISCRETOS NO TOPO -->
                <div class="kpis-container" id="kpisContainer">
                    <div class="kpis-title">
                        üìä Orbiuns por Vendedor
                    </div>
                    <div class="kpis-vendedores" id="kpisVendedores">
                        <!-- KPIs preenchidos via JS -->
                        <div class="loading-spinner"></div>
                    </div>
                    <div class="kpis-total" id="kpisTotal">
                        TOTAL ABERTOS: <span>--</span>
                    </div>
                </div>
                
                <!-- Links R√°pidos -->
                <div class="header-links">
                    <a href="javascript:void(0)" onclick="abrirModalNovoOrbium()" class="header-link">
                        <i class="fas fa-plus-circle"></i> Novo Orbium
                    </a>
                    <a href="javascript:void(0)" onclick="carregarOrbiuns()" class="header-link">
                        <i class="fas fa-sync-alt"></i> Atualizar
                    </a>
                    <a href="javascript:void(0)" onclick="limparFiltros()" class="header-link">
                        <i class="fas fa-filter-circle-xmark"></i> Limpar Filtros
                    </a>
                </div>

                <!-- Filtros -->
                <div class="filter-section">
                    <h4><i class="fas fa-filter"></i> Filtros</h4>
                    <div class="row g-3">
                        <div class="col-md-3">
                            <label class="form-label">N¬∫ Orbium</label>
                            <input type="text" class="form-control form-control-cvc" id="filtroOrbium" 
                                   placeholder="Ex: 2025111713093" onkeyup="filtrarOrbiuns()">
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">Status</label>
                            <select class="form-select form-select-cvc" id="filtroStatus" onchange="filtrarOrbiuns()">
                                <option value="">Todos</option>
                                <option value="Em atendimento">Em atendimento</option>
                                <option value="Problema">Problema</option>
                                <option value="Pendente">Pendente</option>
                                <option value="Resolvido">Resolvido</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">Vendedor</label>
                            <select class="form-select form-select-cvc" id="filtroVendedor" onchange="filtrarOrbiuns()">
                                <option value="">Todos</option>
                                <!-- Preenchido via JS -->
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">Categoria</label>
                            <select class="form-select form-select-cvc" id="filtroCategoria" onchange="filtrarOrbiuns()">
                                <option value="">Todos</option>
                                <option value="CCO">CCO</option>
                                <option value="DV">DV</option>
                                <option value="PRODUTOS">PRODUTOS</option>
                                <option value="GRUPOS ESPEC√çFICOS">GRUPOS ESPEC√çFICOS</option>
                                <option value="CSC">CSC</option>
                                <option value="B2B">B2B</option>
                                <option value="MULTIMARCAS">MULTIMARCAS</option>
                                <option value="TESTES TI">TESTES TI</option>
                                <option value="GRUPOS MAR√çTIMOS">GRUPOS MAR√çTIMOS</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Nome do Cliente</label>
                            <input type="text" class="form-control form-control-cvc" id="filtroCliente" 
                                   placeholder="Ex: Maria Silva" onkeyup="filtrarOrbiuns()">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">WhatsApp</label>
                            <input type="text" class="form-control form-control-cvc" id="filtroWhatsApp" 
                                   placeholder="Ex: 11999999999" onkeyup="filtrarOrbiuns()">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Recibo</label>
                            <input type="text" class="form-control form-control-cvc" id="filtroRecibo" 
                                   placeholder="Ex: 6220-0000128664" onkeyup="filtrarOrbiuns()">
                        </div>
                    </div>
                </div>

                <!-- Lista de Orbiuns -->
                <div id="orbiunsContainer">
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                        <p class="mt-3">Carregando orbiuns...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ============================================================================
         MODAL NOVO ORBIUM
         ============================================================================ -->
    <div class="modal fade" id="modalNovoOrbium" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header modal-header-systelos">
                    <h5 class="modal-title">
                        <i class="fas fa-plus-circle me-2"></i>
                        Novo Orbium
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    
                    <!-- CAMPO COLAR DADOS -->
                    <div class="colar-dados-container">
                        <div class="colar-dados-title">
                            <i class="fas fa-paste"></i>
                            Cole os dados copiados do sistema externo
                        </div>
                        <textarea class="colar-dados-textarea" id="colarDadosTexto" 
                                  placeholder="Cole aqui os dados copiados (RECIBO, CLIENTE, WHATSAPP, RESERVA, CIA, etc)&#10;&#10;Exemplo:&#10;RECIBO: 6220-0000128664&#10;CLIENTE: Maria Silva&#10;WHATSAPP: 11999999999&#10;CIA: GOL&#10;RESERVA: ABC123"></textarea>
                        <button type="button" class="colar-dados-btn mt-3" onclick="analisarDadosColados()">
                            <i class="fas fa-wand-magic-sparkles"></i>
                            Analisar e Preencher Autom√°tico
                        </button>
                        
                        <!-- Feedback Campos Preenchidos -->
                        <div class="campos-preenchidos" id="camposPreenchidos">
                            <h6><i class="fas fa-check-circle me-2"></i>Campos Preenchidos Automaticamente:</h6>
                            <ul id="listaPreenchidos"></ul>
                        </div>
                        
                        <!-- Alerta Campos Vazios -->
                        <div class="campos-vazios" id="camposVazios">
                            <h6><i class="fas fa-exclamation-triangle me-2"></i>Campos Vazios (preencha manualmente):</h6>
                            <ul id="listaVazios"></ul>
                        </div>
                    </div>
                    
                    <!-- FORMUL√ÅRIO -->
                    <form id="formNovoOrbium" onsubmit="salvarOrbium(event)">
                        
                        <!-- Dados B√°sicos -->
                        <div class="form-row-titulo">
                            <i class="fas fa-clipboard"></i>
                            Dados B√°sicos
                        </div>
                        
                        <div class="row g-3 mb-3">
                            <div class="col-md-6">
                                <label class="form-label">
                                    N¬∫ do Orbium <span class="campo-obrigatorio">*</span>
                                </label>
                                <input type="text" class="form-control form-control-cvc" id="numeroOrbium" 
                                       placeholder="Ex: 2025111713093" required>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">
                                    Status <span class="campo-obrigatorio">*</span>
                                </label>
                                <select class="form-select form-select-cvc" id="statusOrbium" required>
                                    <option value="">Selecione...</option>
                                    <option value="Em atendimento">Em atendimento</option>
                                    <option value="Problema">Problema</option>
                                    <option value="Pendente">Pendente</option>
                                    <option value="Resolvido">Resolvido</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="row g-3 mb-3">
                            <div class="col-md-6">
                                <label class="form-label">
                                    Categoria <span class="campo-obrigatorio">*</span>
                                </label>
                                <select class="form-select form-select-cvc" id="categoria" required>
                                    <option value="">Selecione...</option>
                                    <option value="CCO">CCO</option>
                                    <option value="DV">DV</option>
                                    <option value="PRODUTOS">PRODUTOS</option>
                                    <option value="GRUPOS ESPEC√çFICOS">GRUPOS ESPEC√çFICOS</option>
                                    <option value="CSC">CSC</option>
                                    <option value="B2B">B2B</option>
                                    <option value="MULTIMARCAS">MULTIMARCAS</option>
                                    <option value="TESTES TI">TESTES TI</option>
                                    <option value="GRUPOS MAR√çTIMOS">GRUPOS MAR√çTIMOS</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">
                                    Vendedor <span class="campo-obrigatorio">*</span>
                                </label>
                                <select class="form-select form-select-cvc" id="vendedor" required>
                                    <option value="">Selecione...</option>
                                    <!-- Preenchido via JS -->
                                </select>
                            </div>
                        </div>
                        
                        <!-- Dados do Cliente -->
                        <div class="form-row-titulo">
                            <i class="fas fa-user"></i>
                            Dados do Cliente
                        </div>
                        
                        <div class="row g-3 mb-3">
                            <div class="col-md-12">
                                <label class="form-label">
                                    Nome do Cliente <span class="campo-obrigatorio">*</span>
                                </label>
                                <input type="text" class="form-control form-control-cvc" id="nomeCliente" 
                                       placeholder="Ex: Maria Silva" required>
                            </div>
                        </div>
                        
                        <div class="row g-3 mb-3">
                            <div class="col-md-6">
                                <label class="form-label">
                                    WhatsApp <span class="campo-obrigatorio">*</span>
                                </label>
                                <input type="text" class="form-control form-control-cvc" id="whatsappCliente" 
                                       placeholder="Ex: 11999999999" required 
                                       pattern="[0-9]{10,11}" 
                                       title="Digite apenas n√∫meros (10 ou 11 d√≠gitos)">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">CPF do Cliente</label>
                                <input type="text" class="form-control form-control-cvc" id="cpfCliente" 
                                       placeholder="Ex: 123.456.789-00">
                            </div>
                        </div>
                        
                        <!-- Dados da Reserva -->
                        <div class="form-row-titulo">
                            <i class="fas fa-ticket-alt"></i>
                            Dados da Reserva
                        </div>
                        
                        <div class="row g-3 mb-3">
                            <div class="col-md-4">
                                <label class="form-label">Recibo</label>
                                <input type="text" class="form-control form-control-cvc" id="recibo" 
                                       placeholder="Ex: 6220-0000128664">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Reserva</label>
                                <input type="text" class="form-control form-control-cvc" id="reserva" 
                                       placeholder="Ex: ABC123">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Pedido</label>
                                <input type="text" class="form-control form-control-cvc" id="pedido" 
                                       placeholder="Ex: PED123">
                            </div>
                        </div>
                        
                        <div class="row g-3 mb-3">
                            <div class="col-md-4">
                                <label class="form-label">Companhia A√©rea</label>
                                <input type="text" class="form-control form-control-cvc" id="cia" list="listaCias"
                                       placeholder="Digite nome ou sigla...">
                                <datalist id="listaCias">
                                    <!-- NACIONAIS -->
                                    <option value="AZUL (AD)">AZUL (AD)</option>
                                    <option value="GOL (G3)">GOL (G3)</option>
                                    <option value="LATAM (LA)">LATAM (LA)</option>
                                    <option value="VOEPASS (2Z)">VOEPASS (2Z) - antiga Passaredo</option>
                                    <option value="AVIANCA (O6)">AVIANCA (O6)</option>

                                    <!-- INTERNACIONAIS PRINCIPAIS -->
                                    <option value="AMERICAN AIRLINES (AA)">AMERICAN AIRLINES (AA)</option>
                                    <option value="DELTA (DL)">DELTA (DL)</option>
                                    <option value="UNITED (UA)">UNITED (UA)</option>
                                    <option value="LUFTHANSA (LH)">LUFTHANSA (LH)</option>
                                    <option value="AIR FRANCE (AF)">AIR FRANCE (AF)</option>
                                    <option value="KLM (KL)">KLM (KL)</option>
                                    <option value="BRITISH AIRWAYS (BA)">BRITISH AIRWAYS (BA)</option>
                                    <option value="IBERIA (IB)">IBERIA (IB)</option>
                                    <option value="TAP PORTUGAL (TP)">TAP PORTUGAL (TP)</option>
                                    <option value="ALITALIA (AZ)">ALITALIA (AZ)</option>
                                    <option value="SWISS (LX)">SWISS (LX)</option>
                                    <option value="TURKISH AIRLINES (TK)">TURKISH AIRLINES (TK)</option>
                                    <option value="EMIRATES (EK)">EMIRATES (EK)</option>
                                    <option value="QATAR AIRWAYS (QR)">QATAR AIRWAYS (QR)</option>
                                    <option value="ETIHAD (EY)">ETIHAD (EY)</option>
                                    <option value="AIR CANADA (AC)">AIR CANADA (AC)</option>
                                    <option value="AEROMEXICO (AM)">AEROMEXICO (AM)</option>
                                    <option value="COPA AIRLINES (CM)">COPA AIRLINES (CM)</option>
                                    <option value="AVIANCA (AV)">AVIANCA (AV)</option>
                                    <option value="AEROLINEAS ARGENTINAS (AR)">AEROLINEAS ARGENTINAS (AR)</option>
                                    <option value="JET BLUE (B6)">JET BLUE (B6)</option>
                                    <option value="SPIRIT (NK)">SPIRIT (NK)</option>
                                    <option value="FRONTIER (F9)">FRONTIER (F9)</option>
                                    <option value="AIR EUROPA (UX)">AIR EUROPA (UX)</option>
                                    <option value="NORWEGIAN (DY)">NORWEGIAN (DY)</option>
                                    <option value="AEROFLOT (SU)">AEROFLOT (SU)</option>
                                    <option value="AIR CHINA (CA)">AIR CHINA (CA)</option>
                                    <option value="CHINA EASTERN (MU)">CHINA EASTERN (MU)</option>
                                    <option value="CHINA SOUTHERN (CZ)">CHINA SOUTHERN (CZ)</option>
                                    <option value="SINGAPORE AIRLINES (SQ)">SINGAPORE AIRLINES (SQ)</option>
                                    <option value="CATHAY PACIFIC (CX)">CATHAY PACIFIC (CX)</option>
                                    <option value="JAPAN AIRLINES (JL)">JAPAN AIRLINES (JL)</option>
                                    <option value="ANA (NH)">ANA (NH)</option>
                                    <option value="KOREAN AIR (KE)">KOREAN AIR (KE)</option>
                                    <option value="THAI AIRWAYS (TG)">THAI AIRWAYS (TG)</option>
                                    <option value="MALAYSIA AIRLINES (MH)">MALAYSIA AIRLINES (MH)</option>
                                    <option value="QANTAS (QF)">QANTAS (QF)</option>
                                    <option value="AIR NEW ZEALAND (NZ)">AIR NEW ZEALAND (NZ)</option>
                                    <option value="SOUTH AFRICAN AIRWAYS (SA)">SOUTH AFRICAN AIRWAYS (SA)</option>
                                    <option value="OUTRAS">OUTRAS</option>
                                </datalist>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">LOC GDS</label>
                                <input type="text" class="form-control form-control-cvc" id="locGds" 
                                       placeholder="Ex: ABC123">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">LOC CIA</label>
                                <input type="text" class="form-control form-control-cvc" id="locCia" 
                                       placeholder="Ex: XYZ789">
                            </div>
                        </div>
                        
                        <!-- Observa√ß√µes -->
                        <div class="form-row-titulo">
                            <i class="fas fa-comment-dots"></i>
                            Observa√ß√µes
                        </div>
                        
                        <div class="row g-3 mb-3">
                            <div class="col-md-12">
                                <label class="form-label">Observa√ß√µes</label>
                                <textarea class="form-control form-control-cvc" id="observacoes" 
                                          rows="4" placeholder="Descreva o problema, solicita√ß√£o ou informa√ß√µes relevantes..."></textarea>
                            </div>
                        </div>
                        
                        <!-- Bot√µes -->
                        <div class="d-flex gap-3 justify-content-end">
                            <button type="button" class="btn-systelos-secondary" data-bs-dismiss="modal">
                                <i class="fas fa-times me-2"></i>
                                Cancelar
                            </button>
                            <button type="submit" class="btn-systelos-primary" id="salvarDados" style="background-color: #FFB800 !important; color: #0F1B3D !important; font-weight: 600 !important; padding: 14px 40px !important; border: 2px solid #FFB800 !important; border-radius: 10px !important; cursor: pointer !important; font-family: Inter, sans-serif !important; font-size: 16px !important; opacity: 1 !important; visibility: visible !important; display: inline-block !important; transition: all 0.3s ease !important; box-shadow: 0 2px 8px rgba(255,184,0,0.3) !important;">
                                <i class="fas fa-save me-2"></i>
                                Salvar Orbium
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- ============================================================================
         SCRIPTS
         ============================================================================ -->
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- JavaScript Principal -->
    <script>
        // ============================================================================
        // VARI√ÅVEIS GLOBAIS
        // ============================================================================
        let orbiunsData = [];
        let orbiunsFiltrados = [];
        let atualizacoesRecentes = [];
        
        // ============================================================================
        // INICIALIZA√á√ÉO
        // ============================================================================
        document.addEventListener('DOMContentLoaded', async function() {
            debugLog('‚úÖ Sistema de Orbiuns v13.0 WEBHOOK COMPLETO!', 'success');
            debugLog('üîß NOVIDADES v13.0:', 'info');
            debugLog('   1. üÜï Se√ß√£o de atualiza√ß√µes recentes (webhook)', 'info');
            debugLog('   2. üÜï Badge de notifica√ß√µes pulsante', 'info');
            debugLog('   3. üÜï Auto-refresh a cada 5 minutos', 'info');
            debugLog('   4. ‚úÖ KPIs discretos por vendedor', 'info');
            debugLog('   5. ‚úÖ Campo Colar Dados com auto-preenchimento', 'info');
            debugLog('   6. ‚úÖ Feedback visual de campos preenchidos', 'info');
            
            // Carregar vendedores da planilha USUARIOS
            await carregarVendedores();

            // Carregar dados
            await carregarAtualizacoes();
            await carregarOrbiuns();
            
            // Auto-refresh a cada 5 minutos
            setInterval(async () => {
                debugLog('üîÑ Auto-refresh: atualizando dados...', 'info');
                await carregarAtualizacoes();
                await carregarOrbiuns();
            }, 5 * 60 * 1000); // 5 minutos

            // ============================================================================
            // BUSCA AUTOM√ÅTICA POR WHATSAPP ‚Üí CPF + NOME
            // ============================================================================

            const campoWhatsApp = document.getElementById('whatsappCliente');
            if (campoWhatsApp) {
                campoWhatsApp.addEventListener('blur', async function() {
                    const whatsapp = this.value.replace(/\D/g, '');

                    if (whatsapp.length >= 10) {
                        try {
                            debugLog('üîç Buscando cliente por WhatsApp: ' + whatsapp, 'info');

                            const result = await chamarAPI({
                                action: 'buscar_por_whatsapp',
                                whatsapp: whatsapp
                            });

                            if (result.success && result.data) {
                                // Preencher CPF
                                if (result.data.cpf) {
                                    document.getElementById('cpfCliente').value = result.data.cpf;
                                    debugLog('‚úÖ CPF preenchido automaticamente', 'success');
                                }

                                // Preencher Nome
                                if (result.data.nome) {
                                    document.getElementById('nomeCliente').value = result.data.nome;
                                    debugLog('‚úÖ Nome preenchido automaticamente', 'success');
                                }

                                // Feedback visual
                                this.style.borderColor = '#28a745';
                                setTimeout(() => { this.style.borderColor = ''; }, 2000);
                            } else {
                                debugLog('‚ÑπÔ∏è Cliente n√£o encontrado no sistema', 'warning');
                                this.style.borderColor = '#ffc107';
                                setTimeout(() => { this.style.borderColor = ''; }, 2000);
                            }
                        } catch (error) {
                            debugLog('‚ùå Erro ao buscar cliente: ' + error.message, 'error');
                        }
                    }
                });
            }

            // ============================================================================
            // MENU LATERAL - JAVASCRIPT COMPLETO
            // ============================================================================

            const menuToggle = document.querySelector('.navbar-toggler');
            const sidebarMenu = document.getElementById('sidebarMenu');
            const closeSidebar = document.getElementById('closeSidebar');

            // Criar overlay se n√£o existir
            let overlay = document.getElementById('sidebarOverlay');
            if (!overlay) {
                overlay = document.createElement('div');
                overlay.id = 'sidebarOverlay';
                overlay.style.cssText = 'position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.7); z-index: 9998; display: none; transition: opacity 0.3s; backdrop-filter: blur(3px);';
                document.body.appendChild(overlay);
            }

            // Abrir menu
            if (menuToggle) {
                menuToggle.addEventListener('click', function(e) {
                    e.stopPropagation();
                    sidebarMenu.classList.add('show');
                    overlay.style.display = 'block';
                    setTimeout(() => { overlay.style.opacity = '1'; }, 10);
                    debugLog('üîì Menu lateral aberto', 'info');
                });
            }

            // Fechar menu - bot√£o X
            if (closeSidebar) {
                closeSidebar.addEventListener('click', function() {
                    sidebarMenu.classList.remove('show');
                    overlay.style.opacity = '0';
                    setTimeout(() => { overlay.style.display = 'none'; }, 300);
                    debugLog('üîí Menu lateral fechado', 'info');
                });
            }

            // Fechar menu - clique no overlay
            if (overlay) {
                overlay.addEventListener('click', function() {
                    sidebarMenu.classList.remove('show');
                    overlay.style.opacity = '0';
                    setTimeout(() => { overlay.style.display = 'none'; }, 300);
                });
            }

            // Fechar menu - tecla ESC
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && sidebarMenu && sidebarMenu.classList.contains('show')) {
                    sidebarMenu.classList.remove('show');
                    overlay.style.opacity = '0';
                    setTimeout(() => { overlay.style.display = 'none'; }, 300);
                }
            });
        });
        
        // ============================================================================
        // SISTEMA DE NOTIFICA√á√ïES WEBHOOK
        // ============================================================================
        
        async function carregarAtualizacoes() {
            debugLog('üì• Buscando atualiza√ß√µes recentes...', 'info');
            
            try {
                const result = await chamarAPI({
                    action: 'listar_atualizacoes_recentes'
                });
                
                if (result.success && result.data) {
                    atualizacoesRecentes = result.data.atualizacoes || [];
                    
                    debugLog(`‚úÖ ${atualizacoesRecentes.length} atualiza√ß√£o(√µes) carregada(s)`, 'success');
                    
                    renderizarAtualizacoes();
                } else {
                    debugLog('‚ö†Ô∏è Nenhuma atualiza√ß√£o recente', 'warning');
                    ocultarSecaoAtualizacoes();
                }
                
            } catch (error) {
                debugLog(`‚ùå Erro ao carregar atualiza√ß√µes: ${error.message}`, 'error');
                ocultarSecaoAtualizacoes();
            }
        }
        
        function renderizarAtualizacoes() {
            const secao = document.getElementById('secaoAtualizacoes');
            const lista = document.getElementById('listaAtualizacoes');
            const contador = document.getElementById('contadorNotificacoes');
            
            if (atualizacoesRecentes.length === 0) {
                ocultarSecaoAtualizacoes();
                return;
            }
            
            // Mostrar se√ß√£o
            secao.classList.add('show');
            
            // Atualizar contador
            contador.textContent = atualizacoesRecentes.length;
            
            // Renderizar cards
            lista.innerHTML = atualizacoesRecentes.map(atualizacao => {
                const statusClass = atualizacao.status.toLowerCase()
                    .replace('resolvido', 'resolvido')
                    .replace('em andamento', 'em-andamento')
                    .replace(/\s+/g, '-');
                
                return `
                    <div class="atualizacao-card">
                        <div class="atualizacao-header">
                            <div class="atualizacao-orbium">
                                Orbium ${atualizacao.numeroOrbium || 'N/A'}
                            </div>
                            <div class="atualizacao-status ${statusClass}">
                                <i class="fas fa-circle"></i>
                                ${atualizacao.status || 'Atualiza√ß√£o Recebida'}
                            </div>
                        </div>
                        <div class="atualizacao-body">
                            <div class="atualizacao-info">
                                <i class="fas fa-user"></i>
                                <span>${atualizacao.cliente || 'N/A'}</span>
                            </div>
                            <div class="atualizacao-info">
                                <i class="fas fa-user-tie"></i>
                                <span>${atualizacao.vendedor || 'N/A'}</span>
                            </div>
                            <div class="atualizacao-info">
                                <i class="fas fa-building"></i>
                                <span>${atualizacao.categoria || 'N/A'}</span>
                            </div>
                        </div>
                        ${atualizacao.observacoes ? `
                            <div class="atualizacao-observacoes">
                                <i class="fas fa-comment-dots me-2"></i>
                                ${atualizacao.observacoes}
                            </div>
                        ` : ''}
                        <div class="atualizacao-footer">
                            <div class="atualizacao-timestamp">
                                <i class="fas fa-clock"></i>
                                ${atualizacao.timestamp || 'Agora'}
                            </div>
                            <button class="btn-marcar-lido" onclick="marcarComoLida('${atualizacao.id}')">
                                <i class="fas fa-check"></i>
                                Marcar como lido
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function ocultarSecaoAtualizacoes() {
            const secao = document.getElementById('secaoAtualizacoes');
            secao.classList.remove('show');
        }
        
        async function marcarComoLida(id) {
            debugLog(`üìù Marcando atualiza√ß√£o ${id} como lida...`, 'info');
            
            try {
                const result = await chamarAPI({
                    action: 'marcar_como_lido',
                    id: id
                });
                
                if (result.success) {
                    debugLog('‚úÖ Atualiza√ß√£o marcada como lida', 'success');
                    
                    // Remover da lista
                    atualizacoesRecentes = atualizacoesRecentes.filter(a => a.id !== id);
                    
                    // Re-renderizar
                    renderizarAtualizacoes();
                    
                    mostrarAlertaSucesso('‚úÖ Atualiza√ß√£o marcada como lida!');
                } else {
                    throw new Error(result.message || 'Erro ao marcar como lido');
                }
                
            } catch (error) {
                debugLog(`‚ùå Erro: ${error.message}`, 'error');
                mostrarAlertaErro(`‚ùå Erro: ${error.message}`);
            }
        }
        
        async function marcarTodasComoLidas() {
            debugLog('üìù Marcando todas as atualiza√ß√µes como lidas...', 'info');
            
            if (!confirm('Deseja marcar todas as atualiza√ß√µes como lidas?')) {
                return;
            }
            
            try {
                const result = await chamarAPI({
                    action: 'marcar_todas_como_lidas'
                });
                
                if (result.success) {
                    debugLog('‚úÖ Todas as atualiza√ß√µes foram marcadas como lidas', 'success');
                    
                    // Limpar lista
                    atualizacoesRecentes = [];
                    
                    // Ocultar se√ß√£o
                    ocultarSecaoAtualizacoes();
                    
                    mostrarAlertaSucesso('‚úÖ Todas as atualiza√ß√µes foram marcadas como lidas!');
                } else {
                    throw new Error(result.message || 'Erro ao marcar todas como lidas');
                }
                
            } catch (error) {
                debugLog(`‚ùå Erro: ${error.message}`, 'error');
                mostrarAlertaErro(`‚ùå Erro: ${error.message}`);
            }
        }
        
        // ============================================================================
        // COMUNICA√á√ÉO COM API - JSONP PARA BYPASS CORS
        // ============================================================================
        
        async function chamarAPI(dados) {
            try {
                const baseUrl = getApiUrl('googleScript');
                
                debugLog(`üåê Chamando API via JSONP: ${dados.action}`, 'info');
                debugLog(`üìç URL: ${baseUrl}`, 'info');
                
                // Criar callback √∫nico
                const callbackName = 'jsonpCallback_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                
                // Construir URL com par√¢metros
                const params = new URLSearchParams();
                params.append('callback', callbackName);
                
                // Adicionar todos os dados como par√¢metros GET
                Object.keys(dados).forEach(key => {
                    if (typeof dados[key] === 'object') {
                        params.append(key, JSON.stringify(dados[key]));
                    } else {
                        params.append(key, dados[key]);
                    }
                });
                
                const url = `${baseUrl}?${params.toString()}`;
                
                // Criar promessa para JSONP
                return new Promise((resolve, reject) => {
                    // Criar script tag
                    const script = document.createElement('script');
                    
                    // Timeout de 30 segundos
                    const timeout = setTimeout(() => {
                        cleanup();
                        reject(new Error('Timeout: A requisi√ß√£o demorou muito'));
                    }, 30000);
                    
                    // Definir callback global
                    window[callbackName] = function(response) {
                        cleanup();
                        
                        debugLog(`‚úÖ Resposta API: ${response.success ? 'Sucesso' : 'Erro'}`, 
                                response.success ? 'success' : 'error');
                        
                        resolve(response);
                    };
                    
                    // Fun√ß√£o de limpeza
                    function cleanup() {
                        clearTimeout(timeout);
                        if (script.parentNode) {
                            script.parentNode.removeChild(script);
                        }
                        delete window[callbackName];
                    }
                    
                    // Tratar erros
                    script.onerror = function() {
                        cleanup();
                        reject(new Error('Erro ao carregar script da API'));
                    };
                    
                    // Adicionar script ao DOM
                    script.src = url;
                    document.head.appendChild(script);
                });
                
            } catch (error) {
                debugLog(`‚ùå Erro na API: ${error.message}`, 'error');
                throw error;
            }
        }
        
        // ============================================================================
        // CARREGAR ORBIUNS
        // ============================================================================
        
        async function carregarOrbiuns() {
            debugLog('üìã Carregando orbiuns...', 'info');
            
            try {
                const result = await chamarAPI({
                    action: 'listar_orbiuns'
                });
                
                if (result.success && result.data) {
                    orbiunsData = result.data.orbiuns || [];
                    
                    debugLog(`‚úÖ ${orbiunsData.length} orbiuns carregados`, 'success');
                    
                    // Aplicar filtro padr√£o
                    filtrarOrbiuns();
                    
                    // Calcular KPIs
                    calcularKPIs();
                    
                } else {
                    throw new Error(result.message || 'Erro ao carregar orbiuns');
                }
                
            } catch (error) {
                debugLog(`‚ùå Erro ao carregar orbiuns: ${error.message}`, 'error');
                
                document.getElementById('orbiunsContainer').innerHTML = `
                    <div class="loading-container">
                        <i class="fas fa-exclamation-triangle" style="font-size: 3rem; color: var(--systelos-erro); margin-bottom: 15px;"></i>
                        <p style="color: var(--systelos-erro); font-weight: 600;">
                            Erro ao carregar orbiuns: ${error.message}
                        </p>
                        <button onclick="carregarOrbiuns()" class="btn-systelos-primary mt-3">
                            <i class="fas fa-sync-alt me-2"></i>
                            Tentar Novamente
                        </button>
                    </div>
                `;
            }
        }
        
        // ============================================================================
        // RENDERIZAR ORBIUNS
        // ============================================================================
        
        function renderizarOrbiuns() {
            const container = document.getElementById('orbiunsContainer');
            
            if (orbiunsFiltrados.length === 0) {
                container.innerHTML = `
                    <div class="loading-container">
                        <i class="fas fa-inbox" style="font-size: 3rem; color: var(--systelos-texto-claro); margin-bottom: 15px;"></i>
                        <p style="color: var(--systelos-texto-claro); font-weight: 600;">
                            Nenhum orbium encontrado com os filtros aplicados
                        </p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = orbiunsFiltrados.map(orbium => `
                <div class="orbium-card">
                    <div class="orbium-header">
                        <div class="orbium-numero">
                            Orbium ${orbium.orbium || 'N/A'}
                        </div>
                        <div class="orbium-status ${(orbium.status || '').toLowerCase().replace(/\s+/g, '-')}">
                            ${orbium.status || 'Pendente'}
                        </div>
                    </div>
                    
                    <div class="orbium-body">
                        <div class="orbium-info">
                            <i class="fas fa-user"></i>
                            <div>
                                <div class="orbium-info-label">CLIENTE</div>
                                <div class="orbium-info-value">${orbium.nome_cliente || 'N/A'}</div>
                            </div>
                        </div>
                        
                        <div class="orbium-info">
                            <i class="fas fa-user-tie"></i>
                            <div>
                                <div class="orbium-info-label">VENDEDOR</div>
                                <div class="orbium-info-value">${orbium.vendedor || 'N/A'}</div>
                            </div>
                        </div>
                        
                        <div class="orbium-info">
                            <i class="fas fa-building"></i>
                            <div>
                                <div class="orbium-info-label">CATEGORIA</div>
                                <div class="orbium-info-value">${orbium.categoria || 'N/A'}</div>
                            </div>
                        </div>
                        
                        <div class="orbium-info">
                            <i class="fas fa-phone"></i>
                            <div>
                                <div class="orbium-info-label">WHATSAPP</div>
                                <div class="orbium-info-value">${formatarWhatsApp(orbium.whats_cliente)}</div>
                            </div>
                        </div>
                        
                        ${orbium.recibo ? `
                            <div class="orbium-info">
                                <i class="fas fa-receipt"></i>
                                <div>
                                    <div class="orbium-info-label">RECIBO</div>
                                    <div class="orbium-info-value">${orbium.recibo}</div>
                                </div>
                            </div>
                        ` : ''}
                        
                        ${orbium.reserva ? `
                            <div class="orbium-info">
                                <i class="fas fa-ticket-alt"></i>
                                <div>
                                    <div class="orbium-info-label">RESERVA</div>
                                    <div class="orbium-info-value">${orbium.reserva}</div>
                                </div>
                            </div>
                        ` : ''}
                        
                        ${orbium.cia ? `
                            <div class="orbium-info">
                                <i class="fas fa-plane"></i>
                                <div>
                                    <div class="orbium-info-label">CIA</div>
                                    <div class="orbium-info-value">${orbium.cia}</div>
                                </div>
                            </div>
                        ` : ''}
                    </div>
                    
                    ${orbium.observacoes ? `
                        <div class="orbium-observacoes">
                            <strong><i class="fas fa-comment-dots me-2"></i>Observa√ß√µes:</strong>
                            ${orbium.observacoes}
                        </div>
                    ` : ''}
                    
                    <div class="orbium-footer">
                        <div class="orbium-data">
                            <i class="fas fa-calendar-alt me-2"></i>
                            ${formatarData(orbium.data_abertura)}
                        </div>
                        
                        <div class="orbium-actions">
                            ${orbium.whats_cliente ? `
                                <button class="btn-action btn-whatsapp" 
                                        onclick="abrirWhatsApp('${orbium.whats_cliente}', '${orbium.nome_cliente || ''}')">
                                    <i class="fab fa-whatsapp"></i> WhatsApp
                                </button>
                            ` : ''}
                            
                            <button class="btn-action btn-editar" onclick="editarOrbium('${orbium.id}')">
                                <i class="fas fa-edit"></i> Editar
                            </button>
                            
                            <button class="btn-action btn-deletar" onclick="confirmarDelete('${orbium.id}')">
                                <i class="fas fa-trash"></i> Deletar
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        // ============================================================================
        // CALCULAR KPIs
        // ============================================================================
        
        function calcularKPIs() {
            const kpisPorVendedor = {};
            
            // Contar apenas "Em atendimento" e "Problema"
            orbiunsData.forEach(orbium => {
                const status = orbium.status || '';
                if (status === 'Em atendimento' || status === 'Problema') {
                    const vendedor = orbium.vendedor || 'Sem vendedor';
                    kpisPorVendedor[vendedor] = (kpisPorVendedor[vendedor] || 0) + 1;
                }
            });
            
            // Renderizar KPIs
            const kpisContainer = document.getElementById('kpisVendedores');
            const kpisTotal = document.getElementById('kpisTotal');
            
            if (Object.keys(kpisPorVendedor).length === 0) {
                kpisContainer.innerHTML = `
                    <div style="color: rgba(255,255,255,0.7); padding: 20px; text-align: center; width: 100%;">
                        <i class="fas fa-check-circle" style="font-size: 2rem; margin-bottom: 10px;"></i>
                        <div>Nenhum orbium pendente! üéâ</div>
                    </div>
                `;
                kpisTotal.innerHTML = 'TOTAL ABERTOS: <span>0</span>';
                return;
            }
            
            const totalAbertos = Object.values(kpisPorVendedor).reduce((a, b) => a + b, 0);
            
            kpisContainer.innerHTML = Object.entries(kpisPorVendedor)
                .sort((a, b) => b[1] - a[1])
                .map(([vendedor, count]) => `
                    <div class="kpi-vendedor">
                        <div class="kpi-vendedor-nome">${vendedor.split(' ')[0]}</div>
                        <div class="kpi-vendedor-numero">${count}</div>
                        <div class="kpi-vendedor-label">orbiuns</div>
                    </div>
                `).join('');
            
            kpisTotal.innerHTML = `TOTAL ABERTOS: <span>${totalAbertos}</span>`;
        }
        
        // ============================================================================
        // MODAL NOVO ORBIUM
        // ============================================================================
        
        function abrirModalNovoOrbium() {
            const modal = new bootstrap.Modal(document.getElementById('modalNovoOrbium'));
            
            // Limpar formul√°rio
            document.getElementById('formNovoOrbium').reset();
            document.getElementById('colarDadosTexto').value = '';
            document.getElementById('camposPreenchidos').classList.remove('show');
            document.getElementById('camposVazios').classList.remove('show');
            
            modal.show();
        }
        
        // ============================================================================
        // AUTO-PREENCHIMENTO (CAMPO COLAR DADOS)
        // ============================================================================
        
        function analisarDadosColados() {
            const texto = document.getElementById('colarDadosTexto').value;
            
            if (!texto.trim()) {
                mostrarAlertaErro('‚ö†Ô∏è Cole os dados primeiro!');
                return;
            }
            
            debugLog('üîç Analisando dados colados...', 'info');
            
            const dados = extrairDados(texto);
            
            debugLog('üìù Dados extra√≠dos:', 'info');
            debugLog(JSON.stringify(dados, null, 2), 'info');
            
            // Preencher campos
            const camposPreenchidos = [];
            const camposVazios = [];
            
            if (dados.orbium) {
                document.getElementById('numeroOrbium').value = dados.orbium;
                camposPreenchidos.push('N¬∫ do Orbium');
            } else {
                camposVazios.push('N¬∫ do Orbium');
            }
            
            if (dados.cliente) {
                document.getElementById('nomeCliente').value = dados.cliente;
                camposPreenchidos.push('Nome do Cliente');
            } else {
                camposVazios.push('Nome do Cliente');
            }
            
            if (dados.whatsapp) {
                document.getElementById('whatsappCliente').value = dados.whatsapp;
                camposPreenchidos.push('WhatsApp');
            } else {
                camposVazios.push('WhatsApp');
            }
            
            if (dados.cpf) {
                document.getElementById('cpfCliente').value = dados.cpf;
                camposPreenchidos.push('CPF');
            }
            
            if (dados.recibo) {
                document.getElementById('recibo').value = dados.recibo;
                camposPreenchidos.push('Recibo');
            }
            
            if (dados.reserva) {
                document.getElementById('reserva').value = dados.reserva;
                camposPreenchidos.push('Reserva');
            }
            
            if (dados.pedido) {
                document.getElementById('pedido').value = dados.pedido;
                camposPreenchidos.push('Pedido');
            }
            
            if (dados.cia) {
                document.getElementById('cia').value = dados.cia;
                camposPreenchidos.push('Companhia A√©rea');
            }
            
            if (dados.locGds) {
                document.getElementById('locGds').value = dados.locGds;
                camposPreenchidos.push('LOC GDS');
            }
            
            if (dados.locCia) {
                document.getElementById('locCia').value = dados.locCia;
                camposPreenchidos.push('LOC CIA');
            }
            
            // Adicionar categoria e vendedor aos vazios (sempre precisam ser preenchidos)
            camposVazios.push('Status', 'Categoria', 'Vendedor');
            
            // Mostrar feedback
            mostrarFeedbackPreenchimento(camposPreenchidos, camposVazios);
            
            debugLog(`‚úÖ ${camposPreenchidos.length} campos preenchidos automaticamente`, 'success');
        }
        
        function extrairDados(texto) {
            const dados = {};
            
            // Padr√µes de extra√ß√£o melhorados
            const padroes = {
                orbium: /(?:orbium|protocolo|n[u√∫]mero)[:\s]*(\d+)/i,
                recibo: /(?:recibo|contrato)[:\s]*([\w\d-]+)/i,
                cliente: /(?:cliente|passageiro|nome)[:\s]*([^\n]+)/i,
                whatsapp: /(?:whatsapp|whats|telefone|fone|celular)[:\s]*(\d{10,11})/i,
                cpf: /(?:cpf)[:\s]*([\d.-]+)/i,
                reserva: /(?:reserva)[:\s]*([\w\d]+)/i,
                pedido: /(?:pedido|n[u√∫]mero do pedido)[:\s]*([\w\d-]+)/i,
                cia: /(?:fornecedor\s*a[√©e]reo|cia|companhia)[:\s]*([^\n]+)/i,
                locGds: /(?:localizador\s*a[√©e]reo|loc\s*gds|gds)[:\s]*([\w\d]+)/i,
                locCia: /(?:loc\s*cia)[:\s]*([\w\d]+)/i
            };
            
            // Extrair dados
            for (const [campo, padrao] of Object.entries(padroes)) {
                const match = texto.match(padrao);
                if (match && match[1]) {
                    dados[campo] = match[1].trim();
                }
            }
            
            // Limpar WhatsApp (apenas n√∫meros)
            if (dados.whatsapp) {
                dados.whatsapp = dados.whatsapp.replace(/\D/g, '');
            }
            
            // Limpar CPF
            if (dados.cpf) {
                dados.cpf = dados.cpf.replace(/\D/g, '');
                if (dados.cpf.length === 11) {
                    dados.cpf = dados.cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
                }
            }

            // Mapear siglas de companhias a√©reas
            if (dados.cia) {
                const mapaSignas = {
                    'AD': 'AZUL (AD)',
                    'G3': 'GOL (G3)',
                    'LA': 'LATAM (LA)',
                    '2Z': 'VOEPASS (2Z)',
                    'O6': 'AVIANCA (O6)',
                    'AA': 'AMERICAN AIRLINES (AA)',
                    'DL': 'DELTA (DL)',
                    'UA': 'UNITED (UA)',
                    'LH': 'LUFTHANSA (LH)',
                    'AF': 'AIR FRANCE (AF)',
                    'KL': 'KLM (KL)',
                    'BA': 'BRITISH AIRWAYS (BA)',
                    'IB': 'IBERIA (IB)',
                    'TP': 'TAP PORTUGAL (TP)',
                    'AZ': 'ALITALIA (AZ)',
                    'LX': 'SWISS (LX)',
                    'TK': 'TURKISH AIRLINES (TK)',
                    'EK': 'EMIRATES (EK)',
                    'QR': 'QATAR AIRWAYS (QR)',
                    'EY': 'ETIHAD (EY)',
                    'AC': 'AIR CANADA (AC)',
                    'AM': 'AEROMEXICO (AM)',
                    'CM': 'COPA AIRLINES (CM)',
                    'AV': 'AVIANCA (AV)',
                    'AR': 'AEROLINEAS ARGENTINAS (AR)',
                    'B6': 'JET BLUE (B6)',
                    'NK': 'SPIRIT (NK)',
                    'F9': 'FRONTIER (F9)',
                    'UX': 'AIR EUROPA (UX)',
                    'DY': 'NORWEGIAN (DY)',
                    'SU': 'AEROFLOT (SU)',
                    'CA': 'AIR CHINA (CA)',
                    'MU': 'CHINA EASTERN (MU)',
                    'CZ': 'CHINA SOUTHERN (CZ)',
                    'SQ': 'SINGAPORE AIRLINES (SQ)',
                    'CX': 'CATHAY PACIFIC (CX)',
                    'JL': 'JAPAN AIRLINES (JL)',
                    'NH': 'ANA (NH)',
                    'KE': 'KOREAN AIR (KE)',
                    'TG': 'THAI AIRWAYS (TG)',
                    'MH': 'MALAYSIA AIRLINES (MH)',
                    'QF': 'QANTAS (QF)',
                    'NZ': 'AIR NEW ZEALAND (NZ)',
                    'SA': 'SOUTH AFRICAN AIRWAYS (SA)'
                };

                const ciaSigla = dados.cia.toUpperCase().trim();
                if (mapaSignas[ciaSigla]) {
                    dados.cia = mapaSignas[ciaSigla];
                    debugLog(`‚úàÔ∏è Sigla CIA convertida: ${ciaSigla} ‚Üí ${dados.cia}`, 'success');
                }
            }

            return dados;
        }
        
        function mostrarFeedbackPreenchimento(preenchidos, vazios) {
            // Campos preenchidos
            const divPreenchidos = document.getElementById('camposPreenchidos');
            const listaPreenchidos = document.getElementById('listaPreenchidos');
            
            if (preenchidos.length > 0) {
                divPreenchidos.classList.add('show');
                listaPreenchidos.innerHTML = preenchidos.map(campo => `<li>${campo}</li>`).join('');
            } else {
                divPreenchidos.classList.remove('show');
            }
            
            // Campos vazios
            const divVazios = document.getElementById('camposVazios');
            const listaVazios = document.getElementById('listaVazios');
            
            if (vazios.length > 0) {
                divVazios.classList.add('show');
                listaVazios.innerHTML = vazios.map(campo => `<li>${campo}</li>`).join('');
            } else {
                divVazios.classList.remove('show');
            }
        }
        
        // ============================================================================
        // SALVAR ORBIUM
        // ============================================================================
        
        async function salvarOrbium(event) {
            event.preventDefault();
            
            const botaoSubmit = event.target.querySelector('button[type="submit"]');
            const textoOriginal = botaoSubmit.innerHTML;
            
            botaoSubmit.disabled = true;
            botaoSubmit.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Salvando...';
            
            try {
                // Montar dados do orbium
                const dadosOrbium = {
                    orbium: document.getElementById('numeroOrbium').value,
                    status: document.getElementById('statusOrbium').value,
                    categoria: document.getElementById('categoria').value,
                    vendedor: document.getElementById('vendedor').value,
                    nome_cliente: document.getElementById('nomeCliente').value,
                    whats_cliente: document.getElementById('whatsappCliente').value,
                    cpf_cliente: document.getElementById('cpfCliente').value || '',
                    recibo: document.getElementById('recibo').value || '',
                    reserva: document.getElementById('reserva').value || '',
                    pedido: document.getElementById('pedido').value || '',
                    cia: document.getElementById('cia').value || '',
                    loc_gds: document.getElementById('locGds').value || '',
                    loc_cia: document.getElementById('locCia').value || '',
                    observacoes: document.getElementById('observacoes').value || ''
                };
                
                debugLog('üíæ Salvando orbium...', 'info');
                debugLog(JSON.stringify(dadosOrbium, null, 2), 'info');
                
                // Enviar via JSONP - todos os dados como par√¢metros GET
                const result = await chamarAPI({
                    action: 'cadastrar_orbium',
                    // Enviar cada campo individualmente
                    'orbium': dadosOrbium.orbium,
                    'status': dadosOrbium.status,
                    'categoria': dadosOrbium.categoria,
                    'vendedor': dadosOrbium.vendedor,
                    'nome_cliente': dadosOrbium.nome_cliente,
                    'whats_cliente': dadosOrbium.whats_cliente,
                    'cpf_cliente': dadosOrbium.cpf_cliente,
                    'recibo': dadosOrbium.recibo,
                    'reserva': dadosOrbium.reserva,
                    'pedido': dadosOrbium.pedido,
                    'cia': dadosOrbium.cia,
                    'loc_gds': dadosOrbium.loc_gds,
                    'loc_cia': dadosOrbium.loc_cia,
                    'observacoes': dadosOrbium.observacoes
                });
                
                if (result.success) {
                    mostrarAlertaSucesso('‚úÖ Orbium cadastrado com sucesso!');
                    
                    // Fechar modal
                    bootstrap.Modal.getInstance(document.getElementById('modalNovoOrbium')).hide();
                    
                    // Recarregar lista
                    setTimeout(() => {
                        carregarOrbiuns();
                    }, 1000);
                } else {
                    throw new Error(result.message || 'Erro ao cadastrar orbium');
                }
                
            } catch (error) {
                debugLog(`‚ùå Erro ao salvar orbium: ${error.message}`, 'error');
                mostrarAlertaErro(`‚ùå Erro: ${error.message}`);
            } finally {
                botaoSubmit.disabled = false;
                botaoSubmit.innerHTML = textoOriginal;
            }
        }
        
        // ============================================================================
        // EDITAR ORBIUM (PLACEHOLDER)
        // ============================================================================
        
        function editarOrbium(id) {
            mostrarAlertaErro('‚ö†Ô∏è Fun√ß√£o de edi√ß√£o em desenvolvimento');
        }
        
        // ============================================================================
        // DELETAR ORBIUM
        // ============================================================================
        
        async function confirmarDelete(id) {
            if (!confirm('‚ö†Ô∏è Tem certeza que deseja deletar este orbium?\n\nEsta a√ß√£o n√£o pode ser desfeita!')) {
                return;
            }
            
            try {
                debugLog(`üóëÔ∏è Deletando orbium: ${id}`, 'info');
                
                const result = await chamarAPI({
                    action: 'deletar_orbium',
                    id: id
                });
                
                if (result.success) {
                    mostrarAlertaSucesso('‚úÖ Orbium deletado com sucesso!');
                    setTimeout(() => {
                        carregarOrbiuns();
                    }, 1000);
                } else {
                    throw new Error(result.message || 'Erro ao deletar orbium');
                }
                
            } catch (error) {
                debugLog(`‚ùå Erro ao deletar orbium: ${error.message}`, 'error');
                mostrarAlertaErro(`‚ùå Erro: ${error.message}`);
            }
        }
        
        // ============================================================================
        // ABRIR WHATSAPP
        // ============================================================================
        
        function abrirWhatsApp(numero, nome) {
            if (!numero) {
                mostrarAlertaErro('‚ö†Ô∏è N√∫mero de WhatsApp n√£o dispon√≠vel!');
                return;
            }
            
            const numeroLimpo = numero.toString().replace(/\D/g, '');
            const mensagem = `Ol√° ${nome || 'Cliente'}! Aqui √© da CVC Itaqu√°. Como posso ajudar?`;
            const mensagemEncoded = encodeURIComponent(mensagem);
            
            const url = `https://wa.me/55${numeroLimpo}?text=${mensagemEncoded}`;
            window.open(url, '_blank');
            
            debugLog(`üì± WhatsApp aberto: ${numeroLimpo}`, 'info');
        }
        
        // ============================================================================
        // FILTROS
        // ============================================================================
        
        function filtrarOrbiuns() {
            const filtros = {
                orbium: document.getElementById('filtroOrbium').value.toLowerCase(),
                status: document.getElementById('filtroStatus').value.toLowerCase(),
                vendedor: document.getElementById('filtroVendedor').value.toLowerCase(),
                categoria: document.getElementById('filtroCategoria').value.toLowerCase(),
                cliente: document.getElementById('filtroCliente').value.toLowerCase(),
                whatsapp: document.getElementById('filtroWhatsApp').value,
                recibo: document.getElementById('filtroRecibo').value.toLowerCase()
            };
            
            const temFiltroAtivo = Object.values(filtros).some(v => v !== '');
            
            if (!temFiltroAtivo) {
                // Sem filtros: mostrar apenas Problemas e Em atendimento
                orbiunsFiltrados = orbiunsData.filter(o => 
                    o.status === 'Problema' || o.status === 'Em atendimento'
                );
            } else {
                // Com filtros: aplicar em todos os dados
                orbiunsFiltrados = orbiunsData.filter(orbium => {
                    if (filtros.orbium && (!orbium.orbium || !orbium.orbium.toString().toLowerCase().includes(filtros.orbium))) {
                        return false;
                    }
                    if (filtros.status && (!orbium.status || !orbium.status.toString().toLowerCase().includes(filtros.status))) {
                        return false;
                    }
                    if (filtros.vendedor && (!orbium.vendedor || !orbium.vendedor.toString().toLowerCase().includes(filtros.vendedor))) {
                        return false;
                    }
                    if (filtros.categoria && (!orbium.categoria || !orbium.categoria.toString().toLowerCase().includes(filtros.categoria))) {
                        return false;
                    }
                    if (filtros.cliente && (!orbium.nome_cliente || !orbium.nome_cliente.toString().toLowerCase().includes(filtros.cliente))) {
                        return false;
                    }
                    if (filtros.whatsapp && (!orbium.whats_cliente || !orbium.whats_cliente.toString().includes(filtros.whatsapp))) {
                        return false;
                    }
                    if (filtros.recibo && (!orbium.recibo || !orbium.recibo.toString().toLowerCase().includes(filtros.recibo))) {
                        return false;
                    }
                    return true;
                });
            }
            
            renderizarOrbiuns();
            debugLog(`üîç Filtros aplicados: ${orbiunsFiltrados.length} de ${orbiunsData.length} orbiuns exibidos`, 'info');
        }
        
        function limparFiltros() {
            document.getElementById('filtroOrbium').value = '';
            document.getElementById('filtroStatus').value = '';
            document.getElementById('filtroVendedor').value = '';
            document.getElementById('filtroCategoria').value = '';
            document.getElementById('filtroCliente').value = '';
            document.getElementById('filtroWhatsApp').value = '';
            document.getElementById('filtroRecibo').value = '';
            
            // Voltar ao filtro padr√£o
            orbiunsFiltrados = orbiunsData.filter(o => 
                o.status === 'Problema' || o.status === 'Em atendimento'
            );
            renderizarOrbiuns();
        }
        
        // ============================================================================
        // FUN√á√ïES AUXILIARES
        // ============================================================================
        
        function formatarWhatsApp(numero) {
            if (!numero) return 'N/A';
            const numeroLimpo = numero.toString().replace(/\D/g, '');
            if (numeroLimpo.length === 11) {
                return `(${numeroLimpo.slice(0,2)}) ${numeroLimpo.slice(2,7)}-${numeroLimpo.slice(7)}`;
            }
            return numero;
        }
        
        function formatarData(data) {
            if (!data) return 'N/A';
            try {
                const dataObj = new Date(data);
                if (isNaN(dataObj.getTime())) return data;
                return dataObj.toLocaleDateString('pt-BR');
            } catch {
                return data;
            }
        }
        
        async function carregarVendedores() {
            try {
                debugLog('üì• Buscando vendedores da planilha USUARIOS...', 'info');

                const result = await chamarAPI({
                    action: 'listar_usuarios'
                });

                if (result.success && result.data) {
                    const selectVendedor = document.getElementById('vendedor');
                    const selectFiltroVendedor = document.getElementById('filtroVendedor');

                    selectVendedor.innerHTML = '<option value="">Selecione...</option>';
                    selectFiltroVendedor.innerHTML = '<option value="">Todos</option>';

                    // Vendedores ATIVOS
                    const ativos = result.data.filter(u => u.status === 'ATIVO');
                    if (ativos.length > 0) {
                        const optgroupAtivos = document.createElement('optgroup');
                        optgroupAtivos.label = '‚úÖ ATIVOS';
                        ativos.forEach(vendedor => {
                            const option = document.createElement('option');
                            option.value = vendedor.nome;
                            option.textContent = vendedor.nome;
                            optgroupAtivos.appendChild(option);
                        });
                        selectVendedor.appendChild(optgroupAtivos);

                        // Adicionar ao filtro tamb√©m
                        ativos.forEach(vendedor => {
                            const option = document.createElement('option');
                            option.value = vendedor.nome;
                            option.textContent = vendedor.nome;
                            selectFiltroVendedor.appendChild(option);
                        });
                    }

                    // Vendedores DESATIVADOS
                    const desativados = result.data.filter(u => u.status === 'DESLIGADO');
                    if (desativados.length > 0) {
                        const optgroupDesativados = document.createElement('optgroup');
                        optgroupDesativados.label = '‚ùå DESATIVADOS';
                        desativados.forEach(vendedor => {
                            const option = document.createElement('option');
                            option.value = vendedor.nome;
                            option.textContent = vendedor.nome;
                            option.style.color = '#999';
                            optgroupDesativados.appendChild(option);
                        });
                        selectVendedor.appendChild(optgroupDesativados);
                    }

                    debugLog(`‚úÖ ${result.data.length} vendedores carregados`, 'success');
                } else {
                    throw new Error('Erro ao carregar vendedores da API');
                }
            } catch (error) {
                debugLog(`‚ùå Erro ao carregar vendedores: ${error.message}`, 'error');
                debugLog('‚ö†Ô∏è Usando lista de fallback', 'warning');

                // Fallback para lista b√°sica
                const vendedoresFallback = [
                    'ALESSANDRO DIAZ RODRIGUES',
                    'ANA PAULA MUNIZ DE SOUZA',
                    'ADRIELLY CORREA DE SOUSA',
                    'DAINA ADRIANA SILVA DE BRITO',
                    'CONCEPCION DIAZ RODRIGUES'
                ];

                const selectVendedor = document.getElementById('vendedor');
                const selectFiltroVendedor = document.getElementById('filtroVendedor');

                selectVendedor.innerHTML = '<option value="">Selecione...</option>';
                selectFiltroVendedor.innerHTML = '<option value="">Todos</option>';

                vendedoresFallback.forEach(v => {
                    const opt = document.createElement('option');
                    opt.value = v;
                    opt.textContent = v;
                    selectVendedor.appendChild(opt);

                    const optFiltro = document.createElement('option');
                    optFiltro.value = v;
                    optFiltro.textContent = v;
                    selectFiltroVendedor.appendChild(optFiltro);
                });
            }
        }
        
        // ============================================================================
        // SISTEMA DE ALERTAS
        // ============================================================================
        
        function mostrarAlertaSucesso(mensagem) {
            criarAlertaTemporario(mensagem, 'success');
        }
        
        function mostrarAlertaErro(mensagem) {
            criarAlertaTemporario(mensagem, 'error');
        }
        
        function criarAlertaTemporario(mensagem, tipo) {
            const alerta = document.createElement('div');
            alerta.className = tipo === 'success' ? 'alert-custom alert-success-custom' : 'alert-custom alert-error-custom';
            
            alerta.innerHTML = `
                <i class="fas fa-${tipo === 'success' ? 'check-circle' : 'exclamation-circle'}"></i>
                ${mensagem}
                <button onclick="this.parentElement.remove()" 
                        style="background: none; border: none; color: inherit; 
                               font-size: 18px; cursor: pointer; margin-left: 10px;">√ó</button>
            `;
            
            document.body.appendChild(alerta);
            
            setTimeout(() => {
                if (alerta.parentElement) {
                    alerta.remove();
                }
            }, 5000);
        }
        
        // ============================================================================
        // ATALHOS DE TECLADO
        // ============================================================================
        
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'n') {
                e.preventDefault();
                abrirModalNovoOrbium();
            }
        });

        // ============================================================================
        // FECHAR SIDEBAR AO CLICAR NO OVERLAY
        // ============================================================================

        document.addEventListener('DOMContentLoaded', function() {
            const navbarCollapse = document.getElementById('navbarMain');

            if (navbarCollapse) {
                navbarCollapse.addEventListener('click', function(e) {
                    // Se clicar no pr√≥prio collapse (overlay), fechar
                    if (e.target === navbarCollapse) {
                        const bsCollapse = bootstrap.Collapse.getInstance(navbarCollapse);
                        if (bsCollapse) {
                            bsCollapse.hide();
                        }
                    }
                });
            }
        });
    </script>
</body>
</html>